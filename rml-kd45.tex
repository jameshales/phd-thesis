\chapter{Refinement modal logic: \classKFF{} and \classKD{}}\label{rml-kd45}

In this chapter we consider in greater detail the logics \logicRmlKFF{} and \logicRmlKD{}, in the settings of \classKFF{} and \classKD{} respectively.
As in the previous chapter we present sound and complete axiomatisations, provably correct translations from \langRml{} to \langMl{}, and expressive equivalence, compactness and decidability results.
As noted previously, the logic \logicRmlK{} is not a sublogic of \logicRmlKFF{} or \logicRmlKD{}, so our previous results in \logicRmlK{} do not all apply in these settings.
In particular, the axioms {\bf RK}, and {\bf RComm} from \axiomRmlK{} are not sound in \logicRmlKFF{} or \logicRmlKD{}, so we must find replacement axioms.

In the following sections we provide sound and complete axiomatisations for \logicRmlKFF{} and \logicRmlKD{}.
In Section~\ref{rml-kd45-axiomatisation} we provide the axiomatisations for \logicRmlKFF{} and \logicRmlKD{}, which feature syntactic restrictions of the axioms {\bf RK}, {\bf RComm}, and {\bf RDist}.
In Section~\ref{rml-kd45-soundness} we show that the axiomatisations are sound.
In contrast to \logicRmlK{}, in \logicRmlKFF{} and \logicRmlKD{} we must show that the Kripke models that are constructed are \classKFF{} or \classKD{} Kripke models.
This additional requirement accounts for the differences in the axioms compared to \logicRmlK{}.
In Section~\ref{rml-kd45-completeness} we show that the axiomatisations are complete via provably correct translations from \langRml{} to \langMl{}.
In contrast to \logicRmlK{} where conversion to a disjunctive normal form was sufficient for the reduction axioms to be applicable, in \logicRmlKFF{} and \logicRmlKD{} we must use a more restricted normal form to account for the additional syntactic restrictions in the axiomatisations.

\section{Axiomatisation}\label{rml-kd45-axiomatisation}

In this section we present the axiomatisation \axiomRmlKFF{} for the logic \logicRmlKFF{}, and the axiomatisation \axiomRmlKD{} for the logic \logicRmlKD{}.
These axiomatisations are modifications of the axiomatisation \axiomRmlK{} for \logicRmlK{}.
As in \axiomRmlK{} the cover operator features prominently in these axiomatisations.
We discuss and justify the use of the cover operator in Chapter~\ref{rml-k}, where we introduced the axiomatisation \axiomRmlK{}.
The cover operator serves as a convenient notation for a conjunction of modalities that also restricts conjunctions of modalities to cases where the axioms are sound.
However we find that this restriction on notation is not sufficient to ensure that the axioms {\bf RK}, and {\bf RComm} are sound in \logicRmlKFF{} and \logicRmlKD{}.

We know a priori that some of the rules and axioms of \axiomRmlK{} must not be sound in \logicRmlKFF{} and \logicRmlKD{}.
If the axiomatisation \axiomRmlK{} was sound for \logicRmlKFF{} or \logicRmlKD{} then \logicRmlK{} would be a sublogic of these logics, but we previously noted in Proposition~\ref{rml-not-sublogics} that this is not the case.
It is a simple matter to show that the axioms and rules of \axiomK{} are sound for \logicRmlKFF{} and \logicRmlKD{}, and the axioms and rules {\bf R}, {\bf RP}, and {\bf NecR} are sound for \logicRmlKFF{} and \logicRmlKD{} as they were shown to be sound for all variants of \logicRml{} in Proposition~\ref{rml-validities}.
Hence some or all of {\bf RK}, {\bf RComm}, and {\bf RDist} must not be sound for \logicRmlKFF{} and \logicRmlKD{}. 

As we noted in Chapter~\ref{rml}, the logic \logicRmlK{} is not a sublogic of \logicRmlKFF{} or \logicRmlKD{} essentially because each logic quantifies over refinements with different frame conditions.
We gave a specific example, noting that in \logicRmlK{} refinements need not be transitive, so we have $\entails_\logicRmlK{} \possibleA (\lnot \atomP \land \possibleA \atomP) \implies \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP)$, but in \logicRmlKFF{} and \logicRmlKD{} all refinements must be transitive, so we have $\entails \allrefsA (\possibleA \possibleA \atomP \implies \possibleA \atomP)$ and hence $
\entails \lnot (\possibleA (\lnot \atomP \land \possibleA \atomP) \implies \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP))$.
We show how the first validity could be derived using the axiomatisation \axiomRmlK{}.
$$
\begin{array}{ll}
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff \somerefsA \coversA \{\lnot \atomP \land \possibleA \atomP, \lnot \atomP\} & \text{Defn. of $\covers$}\\
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff \somerefsA \coversA \{\lnot \atomP \land \coversA \{\atomP, \top\}, \lnot \atomP\} & \text{Defn. of $\covers$}\\
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff (\possibleA \somerefsA (\lnot \atomP \land \coversA \{\atomP, \top\}) \land \possibleA \somerefsA \lnot \atomP)& {\bf RK}\\
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff (\possibleA \somerefsA (\lnot \atomP \land \coversA \{\atomP, \top\}) \land \possibleA \lnot \atomP)& {\bf RP}\\
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff (\possibleA (\lnot \atomP \land \somerefsA \coversA \{\atomP, \top\}) \land \possibleA \lnot \atomP)& \text{Lemma~\ref{rml-k-theorems}}\\
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff (\possibleA (\lnot \atomP \land \possibleA \somerefsA \atomP \land \possibleA \somerefsA \top) \land \possibleA \lnot \atomP)& {\bf RK}\\
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff (\possibleA (\lnot \atomP \land \possibleA \atomP \land \possibleA \top) \land \possibleA \lnot \atomP)& {\bf RP}\\
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff \possibleA (\lnot \atomP \land \possibleA \atomP)& \text{Modal reasoning}\\
    \proves \possibleA (\lnot \atomP \land \possibleA \atomP) \implies \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) & {\bf P}
\end{array}
$$
However in \logicRmlKFF{} and \logicRmlKD{} we have transitivity and Euclideaness, represented by the modal axioms {\bf 4} and {\bf 5}, and given these axioms we can show that $\proves \lnot \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP)$.
We provide an informal proof.
$$
\begin{array}{ll}
    \proves \necessaryA \lnot \atomP \implies \necessaryA \necessaryA \lnot \atomP & {\bf 4}\\
    \proves \lnot \necessaryA \necessaryA \lnot \atomP \implies \lnot \necessaryA \lnot \atomP & {\bf P}\\
    \proves \possibleA \possibleA \atomP \implies \possibleA \atomP & \text{Defn. of $\possibleA$}\\
    \proves \possibleA \atomP \implies \necessaryA \possibleA \atomP & {\bf 5}\\
    \proves \possibleA \atomP \implies \necessaryA \possibleA \atomP \land \possibleA \atomP & {\bf P}\\
    \proves \possibleA \atomP \implies \possibleA \possibleA \atomP & \text{Modal reasoning}\\
    \proves \possibleA \possibleA \atomP \iff \possibleA \atomP & {\bf P}\\
    \proves (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff (\possibleA \atomP \land \lnot \possibleA \atomP) & {\bf P}\\
    \proves \lnot (\possibleA \atomP \land \lnot \possibleA \atomP) & {\bf P}\\
    \proves \lnot (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) & {\bf MP}\\
    \proves \allrefsA \lnot (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) & {\bf NecR}\\
    \proves \lnot \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) & \text{Defn. of $\somerefsA$}
\end{array}
$$
The formula $\possibleA (\lnot \atomP \land \possibleA \atomP)$ is satisfiable in \logicRmlKFF{} and \logicRmlKD{}, as it is satisfiable in \logicKFF{} and \logicKD{}, and the semantics of these respective logics agree on all modal formulas.
So for sound axiomatisations of \logicRmlKFF{} and \logicRmlKD{} we must have that $\nproves \lnot \possibleA (\lnot \atomP \land \possibleA \atomP)$ and therefore $\proves \lnot (\possibleA (\lnot \atomP \land \possibleA \atomP) \implies \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP))$.
Therefore the derivation of $\proves \possibleA (\lnot \atomP \land \possibleA \atomP) \implies \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP)$ in \axiomRmlK{} above is not sound reasoning for \logicRmlKFF{} or \logicRmlKD{}.
We previously noted that the axioms and rules of axioms and rules of \axiomK{} and the axioms and rules {\bf R}, {\bf RP}, and {\bf NecR} are sound for \logicRmlKFF{} and \logicRmlKD{}, so the flaw in the derivation must be the use of the axiom {\bf RK}, so this axiom is not sound in \logicRmlKFF{} or \logicRmlKD{}.

Above we saw that $\proves \lnot (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP)$, and hence $\proves \lnot \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP)$.
This becomes obvious once we convert $\possibleA \possibleA \atomP \land \lnot \possibleA \atomP$ to the equivalent $\possibleA \atomP \land \lnot \possibleA \atomP$.
If we apply the {\bf RK} axiom to the formula in this syntactic form we see that it behaves as desired for \logicRmlKFF{} and \logicRmlKD{}.
We provide an informal proof.
$$
\begin{array}{ll}
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff \somerefsA (\possibleA \atomP \land \lnot \possibleA \atomP) & \text{Modal reasoning}\\
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff \somerefsA \coversA \{\atomP \land \lnot \atomP, \lnot \atomP\} & \text{Defn. of $\covers$}\\
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff (\possibleA \somerefsA (\atomP \land \lnot \atomP) \land \possibleA \somerefsA \lnot \atomP) & {\bf RK}\\ 
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff (\possibleA (\atomP \land \lnot \atomP) \land \possibleA \lnot \atomP) & {\bf RP}\\ 
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff \possibleA (\atomP \land \lnot \atomP) & \text{Modal reasoning}\\ 
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff \possibleA \bot & {\bf P}\\ 
    \proves \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) \iff \bot & \text{Modal reasoning}\\ 
    \proves \lnot \somerefsA (\possibleA \possibleA \atomP \land \lnot \possibleA \atomP) & {\bf MP}\\ 
\end{array}
$$

A similar problem arises with the axiom {\bf RK} in the setting of \logicRmlKFF{} and \logicRmlKD{}, due to Euclideaness instead of transitivity.
In \logicRmlK{} refinements need not be Euclidean, so we have $\entails_\logicRmlK{} \possibleA \atomP \implies \somerefsA (\possibleA \atomP \land \lnot \necessaryA \possibleA \atomP)$, but in \logicRmlKFF{} and \logicRmlKD{} all refinements must be Euclidean, so we have $\entails \allrefs (\possibleA \atomP \implies \necessaryA \possibleA \atomP)$ and hence $\entails \lnot (\possibleA \atomP \implies \somerefsA (\possibleA \atomP \land \lnot \necessaryA \possibleA \atomP))$.
The contradiction becomes obvious once we convert $\possibleA \atomP \land \lnot \necessaryA \possibleA \atomP$ to the equivalent $\possibleA \atomP \land \lnot \possibleA \atomP$, and again {\bf RK} behaves as desired if applied to the formula in this syntactic form.

The problem with our initial attempt at applying the axiom {\bf RK} occurred because we had a set of formulas, $\{\lnot \atomP \land \possibleA \atomP, \lnot \atomP\}$ that was contradictory when taken together in a cover operator, as in $\coverA \{\lnot \atomP \land \possibleA \atomP, \lnot \atomP\}$, but considered individually each formula is satisfiable in a refinement of a successor, as in $\possibleA \somerefsA (\lnot \atomP \land \possibleA \atomP) \land \possibleA \somerefsA \lnot \atomP$.
The solution we have seen here is to rewrite the formula $\coversA \{\lnot \atomP \land \possibleA \atomP, \lnot \atomP\}$ into the equivalent $\coversA \{\atomP \land \lnot \atomP, \lnot \atomP\}$ where we now have a contradiction when we consider the formulas individually, as in $\possibleA \somerefsA (\atomP \land \lnot \atomP) \land \possibleA \somerefsA \lnot \atomP$.
Rewriting the formula in this way explicitly represents the interaction between the formulas in the cover operator due to transitivity and Euclideaness.
In the rewritten formula there is no interaction between the formulas in the cover operator due to transitivity and Euclideaness, because the formulas in the cover operator do not feature $\agentA$-modalities at the top level.
Therefore any interaction that was implied in the original formula becomes explicit in the rewritten formula.
This makes the contradiction between the formulas due to transitivity and Euclideaness more obvious, and means that considering the formulas individually as is done the {\bf RK} axiom does not result in the contradiction disappearing.

This suggests a method for repairing the axiomatisation \axiomRmlK{} to be sound in \logicRmlKFF{} and \logicRmlKD{}.
Essentially we use the same axioms {\bf RK}, {\bf RComm} and {\bf RDist} from \axiomRmlK{}, but we restrict the formulas that they are applied to, so that modalities may not directly contain modalities belonging to the same agent.
This restriction ensures that the interaction between formulas in the cover operator due to transitivity and Euclideaness are explicitly represented.
We formalise this notion with $\agentsB$-restricted modal formulas.

\begin{definition}[$\agentsB$-restricted modal formulas]
Let $\agentsB \subseteq \agents$ be a set of agents.
A $\agentsB$-restricted modal formula is inductively defined as:
$$
\phi ::= \atomP \mid
         \lnot \phi \mid
         \phi \land \phi \mid
         \necessary[\agentB] \psi
$$
where $\atomP \in \atoms$, $\agentB \in \agentsB$ and $\psi \in \langMl$.
\end{definition}

A $\agentsB$-restricted modal formula is essentially a modal formula that contains only $\agentsB$-modalities at the top level, but which may contain other modalities provided that they appear in the scope of $\agentsB$-modalities.
For example, $\possibleA \atomP \land \necessaryA \atomQ$ and $\necessaryA \possibleB \atomP \land \possibleA \necessaryC \atomQ$ are $\{\agentA\}$-restricted modal formulas as all non-$\agentA$-modalities appear in the scope of $\agentA$-modalities, while $\possibleA \atomP \land \necessaryB \atomQ$ and $\necessaryA \possibleB \atomP \land \possibleC \necessaryA \atomQ$ are {\em not} $\{\agentA\}$-restricted modal formulas as there are non-$\agentA$-modalities that appear outside of the scope of $\agentA$-modalities.

We now present our axiomatisations for \logicRmlKFF{} and \logicRmlKD{}.

\begin{definition}[Axiomatisation \axiomRmlKFF{}]
The axiomatisation \axiomRmlKFF{} is a substitution schema consisting of the axioms and rules of \axiomKFF{} along with the following additional axioms and rules:
$$
\begin{array}{rl}
    {\bf R} & \proves \allrefsBs (\phi \implies \psi) \implies (\allrefsBs \phi \implies \allrefsBs \psi)\\
    {\bf RP} & \proves \allrefsBs \atomP \iff \atomP\\
    {\bf RK45} & \proves \somerefsBs \coversA \Gamma_\agentA \iff \bigwedge_{\gamma \in \Gamma_\agentA} \possibleA \somerefsBs \gamma \text{ where } \agentA \in \agentsB\\
    {\bf RComm} & \proves \somerefsBs \coversA \Gamma_\agentA \iff \coversA \{\somerefsBs \gamma \mid \gamma \in \Gamma_\agentA\} \text{ where } \agentA \notin \agentsB\\
    {\bf RDist} & \proves \somerefsBs \bigwedge_{\agentC \in \agentsC} \coversC \Gamma_\agentC \iff \bigwedge_{\agentC \in \agentsC} \somerefsBs \coversC \Gamma_\agentC\\
    {\bf NecR} & \text{From } \proves \phi \text{ infer } \proves \allrefsBs \phi
\end{array}
$$
where $\phi, \psi \in \langRml$, $\pi \in \langPl$, $\agentA \in \agents$, $\agentsB, \agentsC \subseteq \agents$, and for every $\agentA \in \agents$: $\Gamma_\agentA$ is a finite set of $(\agents \setminus \{\agentA\})$-restricted modal formulas.
\end{definition}

\begin{definition}[Axiomatisation \axiomRmlKD{}]
The axiomatisation \axiomRmlKD{} is a substitution schema consisting of the axioms and rules of \axiomKD{} along with the following additional axioms and rules:
$$
\begin{array}{rl}
    {\bf R} & \proves \allrefsBs (\phi \implies \psi) \implies (\allrefsBs \phi \implies \allrefsBs \psi)\\
    {\bf RP} & \proves \allrefsBs \atomP \iff \atomP\\
    {\bf RKD45} & \proves \somerefsBs \coversA \Gamma'_\agentA \iff \bigwedge_{\gamma' \in \Gamma'_\agentA} \possibleA \somerefsBs \gamma' \text{ where } \agentA \in \agentsB\\
    {\bf RComm} & \proves \somerefsBs \coversA \Gamma_\agentA \iff \coversA \{\somerefsBs \gamma \mid \gamma \in \Gamma_\agentA\} \text{ where } \agentA \notin \agentsB\\
    {\bf RDist} & \proves \somerefsBs \bigwedge_{\agentC \in \agentsC} \coversC \Gamma_\agentC \iff \bigwedge_{\agentC \in \agentsC} \somerefsBs \coversC \Gamma_\agentC\\
    {\bf NecR} & \text{From } \proves \phi \text{ infer } \proves \allrefsBs \phi
\end{array}
$$
where $\phi, \psi \in \langRml$, $\pi \in \langPl$, $\agentA \in \agents$, $\agentsB, \agentsC \subseteq \agents$, and for every $\agentA \in \agents$: $\Gamma_\agentA$ is a non-empty, finite set of $(\agents \setminus \{\agentA\})$-restricted modal formulas.
\end{definition}

We emphasise that the only difference between \axiomRmlKFF{} and \axiomRmlKD{} is that in \axiomRmlKD{} we require that the cover operators in the axioms {\bf RKD45}, {\bf RComm}, and {\bf RDist} be applied to non-empty sets of formulas.
This accounts for the only difference between \classKFF{} and \classKD{}: we require seriality in \classKD{}, but not in \classKFF{}.
We note that strictly speaking, {\bf RComm} and {\bf RDist} are sound in \logicRmlKD{} when the cover operators are applied to empty sets of formulas, but this is derivable from the other axioms using the fact that $\proves \lnot \coversA \emptyset$ in \axiomKFF{}.

\section{Soundness}\label{rml-kd45-soundness}

In this section we show that the axiomatisations \axiomRmlKFF{} and \axiomRmlKD{} are sound with respect to the semantics of the logics \logicRmlKFF{} and \logicRmlKD{} respectively.
As in \logicRmlK{}, the axioms {\bf R} and {\bf RP}, and the rule {\bf NecR} are already known to be sound as they were established for all variants of \logicRml{} in Proposition~\ref{rml-validities}.
What remains to be shown is that the axioms {\bf RK45}, {\bf RKD45}, {\bf RComm}, and {\bf RDist} are sound.
These axioms are similar to the corresponding axioms from \axiomRmlK{}, and accordingly our proofs of soundness build upon the techniques used to show the soundness of \axiomRmlK{}.
As with \axiomRmlK{}, the left-to-right direction of these equivalences is simple to show, whereas the right-to-left direction is more involved, relying on a construction that combines the refinements described on the right of the equivalence into a single refinement that satisfies the left of the equivalence.
In the constructions used for the soundness proofs of \axiomRmlK{} the refinements described on the right of the equivalence are combined in such a way that preserves bisimilarity of the original refinements, and hence preserves the satisfaction of all modal formulas.
However unlike \logicRmlK{}, in the setting of \logicRmlKFF{} and \logicRmlKD{} we require that all refinements satisfy the \classKFF{} or \classKD{} frame conditions respectively.
The constructions used in our soundness proofs for \axiomRmlKFF{} and \axiomRmlKD{} differ slightly in that they have additional edges in order to ensure the transitive and Euclidean properties.
The requirement to have these additional edges means that the refinements described on the right of the equivalence cannot in general be combined in such a way that preserves bisimilarity of the original refinements.
However with a modification of the construction we can ensure a restricted form of bisimilarity, called $\agentsB$-bisimilarity, which preserves the satisfaction of all $\agentsB$-restricted modal formulas.
As the axioms {\bf RK45}, {\bf RKD45}, {\bf RComm}, and {\bf RDist} may only be applied to $\agentsB$-restricted modal formulas this allows us to show the soundness of these axioms.

We note that the axiomatisations \axiomRmlKFF{} and \axiomRmlKD{} are very similar, the only difference being that the axioms of \axiomRmlKD{} require that the cover operators in the axioms {\bf RKD45}, {\bf RComm}, and {\bf RDist} be applied to non-empty sets of formulas, accounting for the additional requirement of seriality in \classKD{}.
As such we will only show prove the soundness of the axioms of \axiomRmlKFF{} in full detail, noting that the same proof techniques work for \axiomRmlKD{} with some minor considerations for the differences.

We begin by defining $\agentsB$-bisimilarity.

\begin{definition}[$\agentsB$-bisimilarity]
Let $\agentsB \subseteq \agents$ be a set of agents and let $\kPModelAndTuple{\kStateS}$ and $\kPModelAndTupleP{\kStateSP}$ be pointed Kripke models.
Then $\kPModel{\kStateS}$ and $\kPModelP{\kStateSP}$ are $\agentsB$-bisimilar and we write $\kPModel{\kStateS} \bisimilar[\agentsB] \kPModelP{\kStateSP}$ if and only if for every $\atomP \in \atoms$ and $\agentB \in \agentsB$ the following conditions, {\bf atoms-$\atomP$}, {\bf forth-$\agentB$} and {\bf back-$\agentB$} holds:

\paragraph{atoms-$\atomP$}
$\kStateS \in \kValuation(\atomP)$ if and only if $\kStateSP \in \kValuationP(\atomP)$.

\paragraph{forth-$\agentB$}
For every $\kStateT \in \kSuccessorsB{\kStateS}$ there exists $\kStateTP \in \kSuccessorsPB{\kStateSP}$ such that $\kPModel{\kStateT} \bisimilar \kPModelP{\kStateTP}$.

\paragraph{back-$\agentB$}
For every $\kStateTP \in \kSuccessorsPB{\kStateSP}$ there exists $\kStateT \in \kSuccessorsB{\kStateS}$ such that $\kPModel{\kStateT} \bisimilar \kPModelP{\kStateTP}$.
\end{definition}

We show that $\agentsB$-bisimilar Kripke models satisfy the same $\agentsB$-restricted modal formulas.

\begin{lemma}\label{b-restricted-invariance}
Let $\agentsB \subseteq \agents$ be a set of agents and let $\kPModel{\kStateS}$ and $\kPModelP{\kStateSP}$ be pointed Kripke models such that $\kPModel{\kStateS} \bisimilar[\agentsB] \kPModelP{\kStateSP}$.
Then for every $\agentsB$-restricted modal formula $\phi \in \langMl$:
$\kPModel{\kStateS} \entails \phi$ if and only if $\kPModelP{\kStateSP} \entails \phi$.
\end{lemma}

\begin{proof}
Let $\phi \in \langMl$ be a $\agentsB$-restricted modal formula.
Assume without loss of generality that all $\necessaryB$~operators are expressed instead as $\possibleB$~operators.
We show that $\kPModel{\kStateS} \entails \phi$ if and only if $\kPModelP{\kStateSP} \entails \phi$ by induction on the structure of $\phi$.

Suppose that $\phi = \atomP$ for $\atomP \in \atoms$.
Then $\kPModel{\kStateS} \entails \atomP$ if and only if $\kStateS \in \kValuation(\atomP)$.
As $\kPModel{\kStateS} \bisimilar[\agentsB] \kPModelP{\kStateSP}$ then $\kStateS \in \kValuation(\atomP)$ if and only if $\kStateSP \in \kValuationP(\atomP)$.
Finally $\kStateSP \in \kValuationP(\atomP)$ if and only if $\kPModelP{\kStateSP} \entails \atomP$.

Suppose that $\phi = \lnot \psi$ or $\phi = \psi \land \chi$ for $\agentsB$-restricted modal formulas $\psi, \chi \in \langMl$.
These follow directly from the induction hypothesis.

Suppose that $\phi = \possible[\agentB] \psi$ for $\agentB \in \agentsB$ and $\psi \in \langMl$.
Then $\kPModel{\kStateS} \entails \necessary[\agentB] \psi$ if and only if there exists $\kStateT \in \kSuccessorsA{\kStateS}$ such that $\kPModel{\kStateT} \entails \psi$.
As $\kPModel{\kStateS} \bisimilar[\agentsB] \kPModelP{\kStateSP}$ then if there exists $\kStateT \in \kSuccessorsA{\kStateS}$ such that $\kPModel{\kStateT} \entails \psi$ if and only if there exists $\kStateTP \in \kSuccessorsPA{\kStateSP}$ such that $\kPModelP{\kStateTP} \entails \psi$ (as we can find a bisimilar $\kStateTP$ for every $\kStateT$ and vice-versa).
Finally there exists $\kStateTP \in \kSuccessorsPA{\kStateSP}$ such that $\kPModelP{\kStateTP} \entails \psi$ if and only if $\kPModelP{\kStateS} \entails \necessary[\agentB] \psi$.
\end{proof}

We use this lemma to show the soundness of {\bf RK45}, {\bf RKD45}, {\bf RComm}, and {\bf RDist}.

We next show that the axiom {\bf RK45} from \axiomRmlKFF{} is sound.
Recall that the axiom {\bf RK45} takes the form of $\proves \somerefsBs \coversA \Gamma_\agentA \iff \bigwedge_{\gamma \in \Gamma_\agentA} \possibleA \somerefsBs \gamma$ where $\agentsB \subseteq \agents$, $\agentA \in \agentsB$, and $\Gamma_\agentA \subseteq \langRml$ is a finite set of $(\agents \setminus \{\agentA\})$-restricted modal formulas.

\begin{lemma}\label{rml-k45-rk45}
The axiom {\bf RK45} from the axiomatisation \axiomRmlKFF{} is sound with respect to the semantics of the logic \logicRmlKFF{}.
\end{lemma}

\begin{proof}
($\Rightarrow$) Let $\kPModel{\kStateS} \in \classKFF$ be a pointed Kripke model such that $\kPModel{\kStateS} \entails \somerefsBs \coversA \Gamma_\agentA$.
Then we show that $\kPModel{\kStateS} \entails \bigwedge_{\gamma \in \Gamma_\agentA} \possibleA \somerefsBs \gamma$ using essentially the same reasoning as in the proof of soundness of {\bf RK} in Lemma~\ref{rml-k-rk}.
The only additional consideration required for \logicRmlKFF{} is that the refinement must be a \classKFF{} Kripke model, but this is given by the semantics of $\somerefsBs$ in \logicRmlKFF{}.

($\Leftarrow$) Let $\kPModelAndTuple{\kStateS} \in \classKFF$ be a pointed Kripke model such that $\kPModel{\kStateS} \entails \bigwedge_{\gamma \in \Gamma_\agentA} \possibleA \somerefsBs \gamma$.
For every $\gamma \in \Gamma_\agentA$ there exists $\kStateT_\gamma \in \kSuccessorsA{\kStateS}$ and $\kPModelAndTuple[\gamma]{\kStateS[\gamma]} \in \classKFF$ such that $\kPModel{\kStateT_\gamma} \simulatesBs \kPModel[\gamma]{\kStateS[\gamma]}$ and $\kPModel[\gamma]{\kStateS[\gamma]} \entails \gamma$.
We use these refinements to construct a single larger refinement to satisfy the left-hand-side of the {\bf RKD45} equivalence.

Let $\kPModelAndTupleP{\kStateSP}$ be a pointed Kripke model where:
\begin{eqnarray*}
    \kStatesP &=& \{\kStateSP\} \cup \{\kStateSP_\gamma \mid \gamma \in \Gamma_\agentA\} \cup \kStates \cup \bigcup_{\gamma \in \Gamma_\agentA} \kStates[\gamma]\\
    \kAccessibilityPA &=& \{(\kStateSP, \kStateSP_\gamma) \mid \gamma \in \Gamma_\agentA\} \cup \{(\kStateSP_\gamma, \kStateSP_{\gamma'}) \mid \gamma, \gamma' \in \Gamma_\agentA\} \cup \kAccessibilityA \cup \bigcup_{\gamma \in \Gamma_\agentA} \kAccessibilityA[\gamma]\\
    \kAccessibilityPB &=& \{(\kStateSP, \kStateT) \mid \kStateT \in \kSuccessorsB{\kStateS}\} \cup \{(\kStateSP_\gamma, \kStateT[\gamma]) \mid \gamma \in \Gamma_\agentA, \kStateT[\gamma] \in \kSuccessorsB[\gamma]{\kStateS[\gamma]}\} \cup \kAccessibilityB \cup \bigcup_{\gamma \in \Gamma_\agentA} \kAccessibilityB[\gamma]\\
    \kValuationP(\atomP) &=& \{\kStateSP \mid \kStateS \in \kValuation(\atomP)\} \cup \bigcup_{\gamma \in \Gamma_\agentA} \{\kStateSP_\gamma \mid \kStateS[\gamma] \in \kValuation[\gamma](\atomP)\} \cup \kValuation(\atomP) \cup \bigcup_{\gamma \in \Gamma_\agentA} \kValuation[\gamma](\atomP)
\end{eqnarray*}
where $\kStateSP$ and $\kStateSP_\gamma$ for every $\gamma \in \Gamma_\agentA$ are fresh states not appearing in $\kStates$ or $\kStates[\gamma]$ for any $\gamma \in \Gamma_\agentA$, and $\agentB \in \agents \setminus \{\agentA\}$.

We note that by construction $\kModelP \in \classKFF$.

\begin{figure}
    \caption{A schematic of the construction used to show soundness of {\bf RK45}.}\label{rml-k45-rk45-construction}
    \centering
    \begin{tikzpicture}[>=stealth',shorten >=1pt,auto,node distance=7em,thick]

        \node (sp) {\underline{$\kPModelP{\kStateSP} \entails \coversA \{\gamma_1, \dots, \gamma_n\}$}};
        \node (mpn) [above of=sp] {$\kPModelP{\kStateSP_{\gamma_n}} \entails \gamma_n$};
        \node (mpd) [left of=mpn,node distance=5.25em] {$\cdots$};
        \node (mp1) [left of=mpd,node distance=5.25em] {$\kPModelP{\kStateSP_{\gamma_1}} \entails \gamma_1$};
        \node (msn) [above of=mpn] {$\vdots$};
        \node (ms1) [left of=msn,node distance=10.5em] {$\vdots$};
        \node (mgn) [above of=msn] {$\kPModel[\gamma_n]{\kStateS[\gamma_n]} \entails \gamma_n$};
        \node (mgd) [left of=mgn,node distance=5.25em] {$\cdots$};
        \node (mg1) [left of=mgd,node distance=5.25em] {$\kPModel[\gamma_1]{\kStateS[\gamma_1]} \entails \gamma_1$};
        \node (mtn) [above of=mgn] {$\kPModel{\kStateT_{\gamma_n}} \entails \somerefsBs \gamma_n$};
        \node (mtd) [left of=mtn,node distance=5.25em] {$\cdots$};
        \node (mt1) [left of=mtd,node distance=5.25em] {$\kPModel{\kStateT_{\gamma_1}} \entails \somerefsBs \gamma_1$};
        \node (ms) [above of=mtn] {$\kPModel{\kStateS} \entails \possibleA \somerefsBs \gamma_1 \land \cdots \land \possibleA \somerefsBs \gamma_n$};
        \node (mtr) [right of=mtn,node distance=10.5em] {$\kPModel{\kStateT} \entails \top$};

      \path[every node/.style={font=\sffamily\small},->]
        (mt1) edge [swap,dashed] node {$\simulatesBs$} (mg1)
        (mtn) edge [dashed] node {$\simulatesBs$} (mgn)
        (mg1) edge [<->,swap,dashed,bend right] node {$\bisimilar[\agents \setminus \{\agentA\}]$} (mp1)
        (mgn) edge [<->,dashed,bend left] node {$\bisimilar[\agents \setminus \{\agentA\}]$} (mpn)
        (ms) edge [dashed,bend left=90,min distance=10em] node {$\simulatesBs$} (sp)
        (ms) edge [draw=none,dashed,bend right=90,min distance=10em] node {} (sp)
        (sp) edge node {$\agentA$} (mp1)
             edge [swap] node {$\agentA$} (mpn)
        (ms) edge [swap] node {$\agentA$} (mt1)
             edge node {$\agentA$} (mtr)
             edge node {$\agentA$} (mtn)
        (mt1) edge [swap,loop left,distance=1em] node {$\agentA$} (mt1)
        (mtn) edge [swap,loop right,distance=1em] node {$\agentA$} (mtn)
        (mtr) edge [swap,loop right,distance=1em] node {$\agentA$} (mtr)
        (mt1) edge [<->,swap,bend left] node {$\agentA$} (mtn)
        (mtn) edge [<->,swap,bend left] node {$\agentA$} (mtr)
        (mt1) edge [<->,swap,bend left] node {$\agentA$} (mtr)
        (mp1) edge [swap,loop left,distance=1em] node {$\agentA$} (mp1)
        (mpn) edge [swap,loop right,distance=1em] node {$\agentA$} (mpn)
        (mp1) edge [<->,swap,bend right] node {$\agentA$} (mpn)
        (mp1) edge [swap] node {$\agents \setminus \{\agentA\}$} (ms1)
        (mpn) edge node {$\agents \setminus \{\agentA\}$} (msn)
        (mg1) edge node {$\agents \setminus \{\agentA\}$} (ms1)
        (mgn) edge [swap] node {$\agents \setminus \{\agentA\}$} (msn);
    \end{tikzpicture}
\end{figure}

We call each state $\kStateSP_\gamma$ a ``proxy state'' for the corresponding state $\kStateS[\gamma]$.
In general we cannot have the $\kStateS[\gamma]$ states be direct $\agentA$-successors of $\kStateSP$ whilst also having $\kPModelP{\kStateS[\gamma]} \bisimilar \kPModel[\gamma]{\kStateS[\gamma]}$.
This is because our construction would require additional $\agentA$-edges from the $\kStateS[\gamma]$ states in order to satisfy the transitive and Euclidean properties of \classKFF{}.
We introduce proxy states to act a proxy for the non-$\agentA$-successors of the corresponding refinement state, so that $\kPModelP{\kStateSP_\gamma} \bisimilar[(\agents \setminus \{\agentA\})] \kPModel[\gamma]{\kStateS[\gamma]}$.
As each $\gamma$ is a $(\agents \setminus \{\agentA\})$-restricted modal formula, and $(\agents \setminus \{\agentA\})$-bisimilar Kripke models agree on $(\agents \setminus \{\agentA\})$-restricted modal formulas, this is enough to ensure that $\kPModelP{\kStateSP_\gamma} \entails \gamma$.

A schematic of the Kripke model $\kPModelP{\kStateSP}$ and an overview of our construction is shown in Figure~\ref{rml-k45-rk45-construction}.
The construction is similar in essence to the construction used for the soundness proof of soundness of {\bf RK} in Lemma~\ref{rml-k-rk}.
Here we can see that each of the $\agentsB$-refinements at successors, $\kPModel[\gamma_1]{\kStateT[\gamma_1]}, \dots, \kPModel[\gamma_n]{\kStateT[\gamma_n]}$, are combined into the larger Kripke model $\kPModelP{\kStateSP}$.
We can see the use of the proxy states $\kPModelP{\kStateS_{\gamma_1}}, \dots, \kPModelP{\kStateS_{\gamma_n}}$, which have all of the $(\agents \setminus \{\agentA\})$-successors of the respective refinements $\kPModel[\gamma_1]{\kStateT[\gamma_1]}, \dots, \kPModel[\gamma_n]{\kStateT[\gamma_n]}$.
We note that the proxy states are $(\agents \setminus \{\agentA\})$-bisimilar to the respective refinements, and therefore satisfy the respective $(\agents \setminus \{\agentA\})$-restricted formulas $\gamma_1, \dots, \gamma_n$.
We note that the proxy states have additional transitive and Euclidean edges in order to ensure that $\kModelP \in \classKFF$, and these additional edges are why the proxy states are not fully bisimilar to the respective refinements.
From this schematic representation we can clearly see that $\kPModelP{\kStateSP} \entails \coversA \{\gamma_1, \dots, \gamma_n\}$.
It is less clear that $\kPModel{\kStateS} \simulatesBs \kPModelP{\kStateSP}$, but we will show this next.
We note that there are $\agentA$-successors of $\kPModel{\kStateS}$ that do not satisfy any $\somerefsBs \gamma_i$ and do not correspond to any $\agentsB$-refinement $\kPModel[\gamma_i]{\kStateT[\gamma_i]}$.
This is permissible as $\agentA \in \agentsB$ and so {\bf forth-$\agentA$} is not required in order for $\kPModelP{\kStateSP}$ to be a $\agentsB$-refinement of $\kPModel{\kStateS}$.

To show that $\kPModel{\kStateS} \entails \somerefsBs \coversA \Gamma_\agentA$ we will show that $\kPModel{\kStateS} \simulatesBs \kPModelP{\kStateSP}$ and $\kPModelP{\kStateSP} \entails \coversA \Gamma_\agentA$.

We first show that $\kPModel{\kStateS} \simulatesBs \kPModelP{\kStateSP}$.

For every $\gamma \in \Gamma_\agentA$ let $\refinement^\gamma \subseteq \kStates \times \kStates[\gamma]$ be a $\agentsB$-refinement from $\kPModel{\kStateT_\gamma}$ to $\kPModel[\gamma]{\kStateS[\gamma]}$.
We define $\refinement \subseteq \kStates \times \kStatesP$ where:
$$
\refinement = \{(\kStateS, \kStateSP)\} \cup \{(\kStateT_\gamma, \kStateSP_\gamma) \mid \gamma \in \Gamma_\agentA\} \cup \{(\kStateT, \kStateT) \mid \kStateT \in \kStates\} \cup \bigcup_{\gamma \in \Gamma_\agentA} \refinement^\gamma
$$
We show that $\refinement$ is a $\agentsB$-refinement from $\kPModel{\kStateS}$ to $\kPModelP{\kStateSP}$.

Let $\atomP \in \atoms$, $\agentB \in \agents$, $\agentC \in \agents \setminus \agentsB$.
We show by cases that the relationships in $\refinement$ satisfy the conditions {\bf atoms-$\atomP$}, {\bf forth-$\agentC$}, and {\bf back-$\agentB$}.

\begin{description}
    \item[Case $(\kStateS, \kStateSP) \in \refinement$:]
        \hfill
        \begin{description}
            \item[atoms-$\atomP$] 
                By construction $\kStateS \in \kValuation(\atomP)$ if and only if $\kStateSP \in \kValuationP(\atomP)$.
            \item[forth-$\agentC$]
                Let $\kStateT \in \kSuccessorsC{\kStateS}$.
                As $\agentC \in \agents \setminus \agentsB$ and $\agentA \in \agentsB$ then $\agentC \neq \agentA$.
                By construction $\kSuccessorsPC{\kStateSP} = \kSuccessorsC{\kStateS}$.
                Then $\kStateT \in \kSuccessorsPC{\kStateSP}$ and by construction $(\kStateT, \kStateT) \in \refinement$.
            \item[back-$\agentB$]
                Suppose that $\agentB = \agentA$.
                Let $\kStateSP_\gamma \in \kSuccessorsPA{\kStateSP}$ where $\gamma \in \Gamma_\agentA$.
                By hypothesis $\kStateT_\gamma \in \kSuccessorsA{\kStateS}$ and $(\kStateT_\gamma, \kStateSP_\gamma) \in \refinement^\gamma \subseteq \refinement$.

                Suppose that $\agentB \neq \agentA$.
                Let $\kStateT \in \kSuccessorsPB{\kStateSP}$.
                By construction $\kSuccessorsPB{\kStateSP} = \kSuccessorsB{\kStateS}$.
                Then $\kStateT \in \kSuccessorsB{\kStateS}$ and by construction $(\kStateT, \kStateT) \in \refinement$.
        \end{description}
    \item[Case $(\kStateT_\gamma, \kStateSP_\gamma) \in \refinement$ where $\gamma \in \Gamma_\agentA$:]
        \hfill
        \begin{description}
            \item[atoms-$\atomP$] 
                By hypothesis $(\kStateT_\gamma, \kStateS[\gamma]) \in \refinement^\gamma$.
                By {\bf atoms-$\atomP$} for $\refinement^\gamma$ we have $\kStateT_\gamma \in \kValuation(\atomP)$ if and only if $\kStateS[\gamma] \in \kValuation[\gamma](\atomP)$.
                By construction $\kStateS[\gamma] \in \kValuation[\gamma](\atomP)$ if and only if $\kStateSP_\gamma \in \kValuationP(\atomP)$.
            \item[forth-$\agentC$]
                Let $\kStateU \in \kSuccessorsC{\kStateT_\gamma}$.
                As $\agentC \in \agents \setminus \agentsB$ and $\agentA \in \agentsB$ then $\agentC \neq \agentA$.
                By hypothesis $(\kStateT_\gamma, \kStateS[\gamma]) \in \refinement^\gamma$.
                By {\bf forth-$\agentC$} for $\refinement^\gamma$ there exists $\kStateU[\gamma] \in \kSuccessorsC[\gamma]{\kStateS[\gamma]}$ such that $(\kStateU, \kStateU[\gamma]) \in \refinement^\gamma$.
                By construction $\kSuccessorsPC{\kStateSP_\gamma} = \kSuccessorsC[\gamma]{\kStateS[\gamma]}$.
                Then $\kStateU[\gamma] \in \kSuccessorsPC{\kStateSP_\gamma}$ and $(\kStateU, \kStateU[\gamma]) \in \refinement$.
            \item[back-$\agentB$]
                Suppose that $\agentB = \agentA$.
                By construction $\kSuccessorsPA{\kStateSP_\gamma} = \{\kStateSP_{\gamma'} \mid \gamma' \in \Gamma_\agentA$.
                Let $\kStateSP_{\gamma'} \in \kSuccessorsPA{\kStateSP_\gamma}$ where $\gamma' \in \Gamma_\agentA$.
                By hypothesis $\kStateT_{\gamma}, \kStateT_{\gamma'} \in \kSuccessorsA{\kStateS}$ and by the Euclideaness of $\kModel$ we have that $\kStateT_{\gamma'} \in \kSuccessorsA{\kStateT_\gamma}$.
                By construction $(\kStateT_{\gamma'}, \kStateSP_{\gamma'}) \in \refinement$.

                Suppose that $\agentB \neq \agentA$.
                Let $\kStateT[\gamma] \in \kSuccessorsPA{\kStateSP_\gamma}$.
                By hypothesis $(\kStateT_\gamma, \kStateS[\gamma]) \in \refinement^\gamma$.
                By {\bf back-$\agentB$} for $\refinement^\gamma$ there exists $\kStateU \in \kSuccessorsB{\kStateT_\gamma}$ such that $(\kStateU, \kStateT[\gamma]) \in \refinement^\gamma \subseteq \refinement$.
        \end{description}
    \item[{Case $(\kStateT, \kStateT) \in \refinement$ where $\kStateT \in \kStates$:}]
        \hfill
        \begin{description}
            \item[atoms-$\atomP$] 
                By construction $\kStateT \in \kValuation(\atomP)$ if and only if $\kStateT \in \kValuationP(\atomP)$.
            \item[forth-$\agentC$]
                Let $\kStateU \in \kSuccessorsC{\kStateT}$.
                By construction $\kSuccessorsPC{\kStateT} = \kSuccessorsC{\kStateT}$.
                Then $\kStateU \in \kSuccessorsPC{\kStateT}$ and by construction $(\kStateU, \kStateU) \in \refinement$.
            \item[back-$\agentB$]
                Let $\kStateU \in \kSuccessorsPB{\kStateT}$.
                By construction $\kSuccessorsPB{\kStateT} = \kSuccessorsB{\kStateT}$.
                Then $\kStateU \in \kSuccessorsB{\kStateT}$ and by construction $(\kStateU, \kStateU) \in \refinement$.
        \end{description}
    \item[{Case $(\kStateT, \kStateT[\gamma]) \in \refinement^\gamma \subseteq \refinement$ where $\gamma \in \Gamma_\agentA$:}]
        \hfill
        \begin{description}
            \item[atoms-$\atomP$] 
                By {\bf atoms-$\atomP$} for $\refinement^\gamma$ we have $\kStateT \in \kValuation(\atomP)$ if and only if $\kStateT[\gamma] \in \kValuation[\gamma](\atomP)$.
                By construction $\kStateT[\gamma] \in \kValuation[\gamma](\atomP)$ if and only if $\kStateT[\gamma] \in \kValuationP(\atomP)$.
            \item[forth-$\agentC$]
                Let $\kStateU \in \kSuccessorsC{\kStateT}$.
                By {\bf forth-$\agentC$} for $\refinement^\gamma$ there exists $\kStateU[\gamma] \in \kSuccessorsC[\gamma]{\kStateT[\gamma]}$ such that $(\kStateU, \kStateU[\gamma]) \in \refinement^\gamma$.
                By construction $\kSuccessorsPC{\kStateT} = \kSuccessorsC[\gamma]{\kStateT[\gamma]}$.
                Then $\kStateU[\gamma] \in \kSuccessorsPC{\kStateT[\gamma]}$ and $(\kStateU, \kStateU[\gamma]) \in \refinement$.
            \item[back-$\agentB$]
                Let $\kStateU[\gamma] \in \kSuccessorsPB{\kStateT[\gamma]}$.
                By construction $\kSuccessorsPB{\kStateT[\gamma]} = \kSuccessorsB[\gamma]{\kStateT[\gamma]}$.
                Then $\kStateU[\gamma] \in \kSuccessorsB[\gamma]{\kStateT[\gamma]}$.
                By {\bf back-$\agentB$} for $\refinement^\gamma$ there exists $\kStateU \in \kSuccessorsB{\kStateT}$ such that $(\kStateU, \kStateU[\gamma]) \in \refinement^\gamma \subseteq \refinement$.
        \end{description}
\end{description}

Therefore $\refinement$ is a $\agentsB$-refinement and as $(\kStateS, \kStateSP) \in \refinement$ we have that $\kPModel{\kStateS} \simulatesBs \kPModelP{\kStateSP}$.

Let $\gamma \in \Gamma_\agentA$.
We note for every $\kStateT[\gamma] \in \kStates[\gamma]$ that $\kPModelP{\kStateT[\gamma]} \bisimilar \kPModel[\gamma]{\kStateT[\gamma]}$, as by construction the valuations and successor states of states from $\kModel[\gamma]$ are left unchanged in $\kModelP$.
So we have that $\kPModelP{\kStateSP_\gamma} \bisimilar[\agents \setminus \{\agentA\}] \kPModel[\gamma]{\kStateS[\gamma]}$.
As $\gamma$ is a $(\agents \setminus \{\agentA\})$-restricted modal formula and $\kPModel[\gamma]{\kStateS[\gamma]} \entails \gamma$ then by Lemma~\ref{b-restricted-invariance} we have that $\kPModelP{\kStateSP_\gamma} \entails \gamma$.
Then $\kPModelP{\kStateSP} \entails \coversA \Gamma_\agentA$ follows from the same reasoning as in the proof of soundness of {\bf RK} in Lemma~\ref{rml-k-rk}.
Therefore $\kPModel{\kStateS} \entails \somerefsBs \coversA \Gamma_\agentA$.
\end{proof}

We use similar reasoning to show that the axiom {\bf RKD45} from \axiomRmlKD{} is sound.
Recall that the axiom {\bf RKD45} takes the form of $\proves \somerefsBs \coversA \Gamma_\agentA \iff \bigwedge_{\gamma \in \Gamma_\agentA} \possibleA \somerefsBs \gamma$ where $\agentsB \subseteq \agents$, $\agentA \in \agentsB$, and $\Gamma_\agentA \subseteq \langRml$ is a non-empty, finite set of $(\agents \setminus \{\agentA\})$-restricted modal formulas.
We emphasise again that the only difference between {\bf RK45} and {\bf RKD45} is that {\bf RKD45} requires that $\Gamma_\agentA$ be a non-empty set.
This accounts for the additional requirement in \logicRmlKD{} that refinements must be serial.

\begin{lemma}\label{rml-kd45-rkd45}
The axiom {\bf RKD45} from the axiomatisation \axiomRmlKD{} is sound with respect to the semantics of the logic \logicRmlKD{}.
\end{lemma}

\begin{proof}
The proof of Lemma~\ref{rml-k45-rk45} applies with minor considerations in the setting of \logicRmlKD{}.
For the left-to-right direction the semantics of \logicRmlKD{} require that $\kPModel{\kStateS}, \kPModelP{\kStateSP} \in \classKD$ instead of \classKFF{}, but otherwise the reasoning is the same.
For the right-to-left direction the semantics of \logicRmlKD{} require that $\kPModel{\kStateS} \in \classKD$ and for every $\gamma \in \Gamma_\agentA$ that $\kPModel[\gamma]{\kStateS[\gamma]} \in \classKD$.
We must additionally show here that the constructed model $\kPModelP{\kStateSP} \in \classKD$, but this is trivial given that $\Gamma_\agentA$ is non-empty (ensuring seriality at $\kPModelP{\kStateSP}$) and for every $\gamma \in \Gamma_\agentA$ we have $\kPModel[\gamma]{\kStateS[\gamma]} \in \classKD$ (ensuring seriality elsewhere).
\end{proof}

We next show that the axiom {\bf RComm} from \axiomRmlKFF{} is sound.
Recall that the axiom {\bf RComm} takes the form of $\proves \somerefsBs \coversA \Gamma_\agentA \iff \coversA \{\somerefsBs \gamma \mid \gamma \in \Gamma_\agentA\}$ where $\agentsB \subseteq \agents$, $\agentA \notin \agentsB$, and $\Gamma_\agentA \subseteq \langRml$ is a finite set of $(\agents \setminus \{\agentA\})$-restricted modal formulas.
Also recall the differences between the soundness proofs for {\bf RK} and {\bf RComm} in \axiomRmlK{}.
Whereas for {\bf RK} we had that $\agentA \in \agentsB$ and therefore a $\agentsB$-refinement need not satisfy {\bf forth-$\agentA$}, for {\bf RComm} we had that $\agentA \notin \agentsB$ and so {\bf forth-$\agentA$} is required.
This accounted for the additional refinements $\kPModel[\kStateT]{\kStateS[\kStateT]}$ used in the construction for {\bf RComm} in \axiomRmlK{}.
Similar accommodations must be made for the soundness proof for {\bf RComm} in \axiomRmlKFF{} as compared to the soundness proof for {\bf RK45}.

\begin{lemma}\label{rml-k45-rcomm}
The axiom {\bf RComm} from the axiomatisation \axiomRmlKFF{} is sound with respect to the semantics of the logic \logicRmlKFF{}.
\end{lemma}

\begin{proof}
($\Rightarrow$) Let $\kPModel{\kStateS} \in \classKFF$ be a pointed Kripke model such that $\kPModel{\kStateS} \entails \somerefsBs \coversA \Gamma_\agentA$.
Then we show that $\kPModel{\kStateS} \entails \coversA \{\somerefsBs \gamma \mid \gamma \in \Gamma_\agentA\}$ using similar reasoning to the proof of soundness of {\bf RComm} in Lemma~\ref{rml-k-rcomm}.
The only additional consideration required for \logicRmlKFF{} is that the refinement must be a \classKFF{} Kripke model, but this is given by the semantics of $\somerefsBs$ in \logicRmlKFF{}.

($\Leftarrow$) Let $\kPModelAndTuple{\kStateS} \in \classKFF$ be a pointed Kripke model such that $\kPModel{\kStateS} \entails \coversA \{\somerefsBs \gamma \mid \gamma \in \Gamma_\agentA\}$.
For every $\gamma \in \Gamma_\agentA$ there exists $\kStateT_\gamma \in \kSuccessorsA{\kStateS}$ and $\kPModelAndTuple[\gamma]{\kStateS[\gamma]} \in \classKFF$ such that $\kPModel{\kStateT_\gamma} \simulatesBs \kPModel[\gamma]{\kStateS[\gamma]}$ and $\kPModel[\gamma]{\kStateS[\gamma]} \entails \gamma$.
For every $\kStateT \in \kSuccessorsA{\kStateS}$ there exists $\gamma \in \Gamma_\agentA$ and $\kPModelAndTuple[\kStateT]{\kStateS[\kStateT]} \in \classKFF$ such that $\kPModel{\kStateT} \simulatesBs \kPModel[\kStateT]{\kStateS[\kStateT]}$ and $\kPModel[\kStateT]{\kStateS[\kStateT]} \entails \gamma$.
We use these refinements to construct a single larger refinement to satisfy the left-hand-side of the {\bf RComm} equivalence.

Let $\kPModelAndTupleP{\kStateSP}$ be a pointed Kripke model where:
\begin{eqnarray*}
    \kStatesP &=& \{\kStateSP\} \cup \{\kStateSP_\gamma \mid \gamma \in \Gamma_\agentA\} \cup \{\kStateSP_{\kStateT} \mid \kStateT \in \kSuccessorsA{\kStateS}\} \cup \kStates \cup \bigcup_{\gamma \in \Gamma_\agentA} \kStates[\gamma] \cup \bigcup_{\kStateT \in \kSuccessorsA{\kStateS}} \kStates[\kStateT]\\
    \kAccessibilityPA &=& \{(\kStateSP, \kStateSP_\gamma) \mid \gamma \in \Gamma_\agentA\} \cup \{(\kStateSP, \kStateSP_{\kStateT}) \mid \kStateT \in \kSuccessorsA{\kStateS}\} \cup \{(\kStateSP_x, \kStateSP_y) \mid x, y \in \Gamma_\agentA \cup \kSuccessorsA{\kStateS}\} \cup \\&&\quad \kAccessibilityA \cup \bigcup_{\gamma \in \Gamma_\agentA} \kAccessibilityA[\gamma] \cup \bigcup_{\kStateT \in \kSuccessorsA{\kStateS}} \kAccessibilityA[\kStateT]\\
    \kAccessibilityPB &=& \{(\kStateSP, \kStateT) \mid \kStateT \in \kSuccessorsB{\kStateS}\} \cup \{(\kStateSP_\gamma, \kStateT[\gamma]) \mid \gamma \in \Gamma_\agentA, \kStateT[\gamma] \in \kSuccessorsB[\gamma]{\kStateS[\gamma]}\} \cup \\&&\quad \{(\kStateSP_{\kStateT}, \kStateU[\kStateT]) \mid \kStateT \in \kSuccessorsB{\kStateS}, \kStateU[\kStateT] \in \kSuccessorsB[\gamma]{\kStateS[\kStateT]}\} \cup \kAccessibilityB \cup \bigcup_{\gamma \in \Gamma_\agentA} \kAccessibilityB[\gamma] \cup \bigcup_{\kStateT \in \kSuccessorsA{\kStateS}} \kAccessibilityB[\kStateT]\\
    \kValuationP(\atomP) &=& \{\kStateSP \mid \kStateS \in \kValuation(\atomP)\} \cup \bigcup_{\gamma \in \Gamma_\agentA} \{\kStateSP_\gamma \mid \kStateS[\gamma] \in \kValuation[\gamma](\atomP)\} \cup \bigcup_{\kStateT \in \kSuccessorsA{\kStateS}} \{\kStateSP_{\kStateT} \mid \kStateS[\kStateT] \in \kValuation[\kStateT](\atomP)\} \cup \kValuation(\atomP) \cup \bigcup_{\gamma \in \Gamma_\agentA} \kValuation[\gamma](\atomP) \cup \bigcup_{\kStateT \in \kSuccessorsA{\kStateS}} \kValuation[\kStateT](\atomP)
\end{eqnarray*}
where $\kStateSP$, $\kStateSP_\gamma$ for every $\gamma \in \Gamma_\agentA$ and $\kStateSP_{\kStateT}$ for every $\kStateT \in \kSuccessorsA{\kStateS}$ are fresh states not appearing in $\kStates$, $\kStates[\gamma]$ for any $\gamma \in \Gamma_\agentA$ or $\kStates[\kStateT]$ for any $\kStateT \in \kSuccessorsA{\kStateS}$, and $\agentB \in \agents \setminus \{\agentA\}$.
\begin{figure}
    \caption{A schematic of the construction used to show soundness of {\bf RComm}.}\label{rml-k45-rcomm-construction}
    \centering
    \begin{tikzpicture}[>=stealth',shorten >=1pt,auto,node distance=7em,thick]

        \node (sp) {\underline{$\kPModelP{\kStateSP} \entails \coversA \{\gamma_1, \dots, \gamma_n\}$}};
        \node (mpn) [above of=sp] {$\kPModelP{\kStateSP_{\gamma_n}} \entails \gamma_n$};
        \node (mpr) [right of=mpn,node distance=10.5em] {$\kPModelP{\kStateSP_{\kStateT}} \entails \bigvee \Gamma_\agentA$};
        \node (mpd) [left of=mpn,node distance=5.25em] {$\cdots$};
        \node (mp1) [left of=mpd,node distance=5.25em] {$\kPModelP{\kStateSP_{\gamma_1}} \entails \gamma_1$};
        \node (msn) [above of=mpn] {$\vdots$};
        \node (msr) [right of=msn,node distance=10.5em] {$\vdots$};
        \node (ms1) [left of=msn,node distance=10.5em] {$\vdots$};
        \node (mgn) [above of=msn] {$\kPModel[\gamma_n]{\kStateS[\gamma_n]} \entails \gamma_n$};
        \node (mgr) [above of=msr] {$\kPModel[\kStateT]{\kStateS[\kStateT]} \entails \bigvee \Gamma_\agentA$};
        \node (mgd) [left of=mgn,node distance=5.25em] {$\cdots$};
        \node (mg1) [left of=mgd,node distance=5.25em] {$\kPModel[\gamma_1]{\kStateS[\gamma_1]} \entails \gamma_1$};
        \node (mtn) [above of=mgn] {$\kPModel{\kStateT_{\gamma_n}} \entails \somerefsBs \gamma_n$};
        \node (mtd) [left of=mtn,node distance=5.25em] {$\cdots$};
        \node (mt1) [left of=mtd,node distance=5.25em] {$\kPModel{\kStateT_{\gamma_1}} \entails \somerefsBs \gamma_1$};
        \node (ms) [above of=mtn] {$\kPModel{\kStateS} \entails \possibleA \somerefsBs \gamma_1 \land \cdots \land \possibleA \somerefsBs \gamma_n$};
        \node (mtr) [right of=mtn,node distance=10.5em] {$\kPModel{\kStateT} \entails \top$};

      \path[every node/.style={font=\sffamily\small},->]
        (mt1) edge [swap,dashed] node {$\simulatesBs$} (mg1)
        (mtn) edge [dashed] node {$\simulatesBs$} (mgn)
        (mtr) edge [dashed] node {$\simulatesBs$} (mgr)
        (mg1) edge [<->,swap,dashed,bend right] node {$\bisimilar[\agents \setminus \{\agentA\}]$} (mp1)
        (mgn) edge [<->,dashed,bend left] node {$\bisimilar[\agents \setminus \{\agentA\}]$} (mpn)
        (mgr) edge [<->,dashed,bend left] node {$\bisimilar[\agents \setminus \{\agentA\}]$} (mpr)
        (ms) edge [dashed,bend left=90,min distance=10em] node {$\simulatesBs$} (sp)
        (ms) edge [draw=none,dashed,bend right=90,min distance=10em] node {} (sp)
        (sp) edge node {$\agentA$} (mp1)
             edge [swap] node {$\agentA$} (mpn)
             edge [swap] node {$\agentA$} (mpr)
        (ms) edge [swap] node {$\agentA$} (mt1)
             edge node {$\agentA$} (mtr)
             edge node {$\agentA$} (mtn)
        (mt1) edge [swap,loop left,distance=1em] node {$\agentA$} (mt1)
        (mtn) edge [swap,loop right,distance=1em] node {$\agentA$} (mtn)
        (mtr) edge [swap,loop right,distance=1em] node {$\agentA$} (mtr)
        (mt1) edge [<->,swap,bend left] node {$\agentA$} (mtn)
        (mtn) edge [<->,swap,bend left] node {$\agentA$} (mtr)
        (mt1) edge [<->,swap,bend left] node {$\agentA$} (mtr)
        (mp1) edge [swap,loop left,distance=1em] node {$\agentA$} (mp1)
        (mpn) edge [swap,loop right,distance=1em] node {$\agentA$} (mpn)
        (mpr) edge [swap,loop right,distance=1em] node {$\agentA$} (mpr)
        (mp1) edge [<->,swap,bend right] node {$\agentA$} (mpn)
        (mpn) edge [<->,swap,bend right] node {$\agentA$} (mpr)
        (mp1) edge [<->,swap,bend right] node {$\agentA$} (mpr)
        (mp1) edge [swap] node {$\agents \setminus \{\agentA\}$} (ms1)
        (mpn) edge node {$\agents \setminus \{\agentA\}$} (msn)
        (mpr) edge node {$\agents \setminus \{\agentA\}$} (msr)
        (mg1) edge node {$\agents \setminus \{\agentA\}$} (ms1)
        (mgn) edge [swap] node {$\agents \setminus \{\agentA\}$} (msn)
        (mgr) edge [swap] node {$\agents \setminus \{\agentA\}$} (msr);
    \end{tikzpicture}
\end{figure}

A schematic of the Kripke model $\kPModelP{\kStateSP}$ and an overview of our construction is shown in Figure~\ref{rml-k45-rcomm-construction}.
The construction is similar in essence to the construction used for the soundness proof of soundness of {\bf RComm} in Lemma~\ref{rml-k-rcomm}, however it incorporates the proxy states and additional transitive and Euclidean edges introduced in the construction used for the soundness proof of {\bf RK45} in Lemma~\ref{rml-k45-rk45}.
As in the construction used for {\bf RK45} we can see that each of the $\agentsB$-refinements at successors, $\kPModel[\gamma_1]{\kStateT[\gamma_1]}, \dots, \kPModel[\gamma_n]{\kStateT[\gamma_n]}$, are combined into the larger Kripke model $\kPModelP{\kStateSP}$.
However in contrast to the construction used for {\bf RK45} we note that here every $\agentA$-successor of $\kPModel{\kStateS}$ satisfies $\somerefsBs \gamma$ for some $\gamma \in \Gamma_\agentA$, and corresponds to some $\agentsB$-refinement $\kPModel[\kStateT]{\kStateS[\kStateT]}$.
This is required as $\agentA \in \agentsB$ and so {\bf forth-$\agentA$} is required in order for $\kPModelP{\kStateSP}$ to be a $\agentsB$-refinement of $\kPModel{\kStateS}$.
From this schematic representation we can clearly see that $\kPModelP{\kStateSP} \entails \coversA \{\gamma_1, \dots, \gamma_n\}$.
It is less clear that $\kPModel{\kStateS} \simulatesBs \kPModelP{\kStateSP}$, but we will show this next.

To show that $\kPModel{\kStateS} \entails \somerefsBs \coversA \Gamma_\agentA$ we will show that $\kPModel{\kStateS} \simulatesBs \kPModelP{\kStateSP}$ and $\kPModelP{\kStateSP} \entails \coversA \Gamma_\agentA$.

We first show that $\kPModel{\kStateS} \simulatesBs \kPModelP{\kStateSP}$.

For every $\gamma \in \Gamma_\agentA$ let $\refinement^\gamma \subseteq \kStates \times \kStates[\gamma]$ be a $\agentsB$-refinement from $\kPModel{\kStateT_\gamma}$ to $\kPModel[\gamma]{\kStateS[\gamma]}$ and
for every $\kStateT \in \kSuccessorsA{\kStateS}$ let $\refinement^{\kStateT} \subseteq \kStates \times \kStates[\kStateT]$ be a $\agentsB$-refinement from $\kPModel{\kStateT}$ to $\kPModel[\kStateT]{\kStateS[\kStateT]}$.
We define $\refinement \subseteq \kStates \times \kStatesP$ where:
$$
\begin{array}{rcl}
    \refinement &=& \{(\kStateS, \kStateSP)\} \cup \{(\kStateT_\gamma, \kStateSP_\gamma) \mid \gamma \in \Gamma_\agentA\} \cup \{(\kStateT, \kStateSP_{\kStateT}) \mid \kStateT \in \kSuccessorsA{\kStateS}\} \cup \\&&\quad \{(\kStateT, \kStateT) \mid \kStateT \in \kStates\} \cup \bigcup_{\gamma \in \Gamma_\agentA} \refinement^\gamma \cup \bigcup_{\kStateT \in \kSuccessorsA{\kStateS}} \refinement^{\kStateT}
\end{array}
$$
We show that $\refinement$ is a $\agentsB$-refinement from $\kPModel{\kStateS}$ to $\kPModelP{\kStateSP}$.

Let $\atomP \in \atoms$, $\agentB \in \agents$, $\agentC \in \agents \setminus \agentsB$.
We show by cases that the relationships in $\refinement$ satisfy the conditions {\bf atoms-$\atomP$}, {\bf forth-$\agentC$}, and {\bf back-$\agentB$}.

\begin{description}
    \item[Case $(\kStateS, \kStateSP) \in \refinement$:]
        \hfill
        \begin{description}
            \item[atoms-$\atomP$] 
                By construction $\kStateS \in \kValuation(\atomP)$ if and only if $\kStateSP \in \kValuationP(\atomP)$.
            \item[forth-$\agentC$]
                Suppose that $\agentC = \agentA$.
                Let $\kStateT \in \kSuccessorsA{\kStateS}$.
                By construction $\kStateSP_{\kStateT} \in \kSuccessorsA{\kStateS}$ and $(\kStateT, \kStateSP_{\kStateT}) \in \refinement^{\kStateT} \subseteq \refinement$.

                Suppose that $\agentC \neq \agentA$.
                Let $\kStateT \in \kSuccessorsC{\kStateS}$.
                By construction $\kSuccessorsPC{\kStateSP} = \kSuccessorsC{\kStateS}$.
                Then $\kStateT \in \kSuccessorsPC{\kStateSP}$ and by construction $(\kStateT, \kStateT) \in \refinement$.
            \item[back-$\agentB$]
                Suppose that $\agentB = \agentA$.
                Let $\kStateSP_\gamma \in \kSuccessorsPA{\kStateSP}$ where $\gamma \in \Gamma_\agentA$.
                By hypothesis $\kStateT_\gamma \in \kSuccessorsA{\kStateS}$ and $(\kStateT_\gamma, \kStateSP_\gamma) \in \refinement^\gamma \subseteq \refinement$.
                Let $\kStateSP_{\kStateT} \in \kSuccessorsPA{\kStateSP}$ where $\kStateT \in \kSuccessorsA{\kStateS}$.
                By hypothesis $\kStateT \in \kSuccessorsA{\kStateS}$ and $(\kStateT, \kStateSP_\gamma) \in \refinement^\gamma \subseteq \refinement$.

                Suppose that $\agentB \neq \agentA$.
                Let $\kStateT \in \kSuccessorsPB{\kStateSP}$.
                By construction $\kSuccessorsPB{\kStateSP} = \kSuccessorsB{\kStateS}$.
                Then $\kStateT \in \kSuccessorsB{\kStateS}$ and by construction $(\kStateT, \kStateT) \in \refinement$.
        \end{description}
    \item[Case $(\kStateT_\gamma, \kStateSP_\gamma) \in \refinement$ where $\gamma \in \Gamma_\agentA$:]
        \hfill
        \begin{description}
            \item[atoms-$\atomP$] 
                By hypothesis $(\kStateT_\gamma, \kStateS[\gamma]) \in \refinement^\gamma$.
                By {\bf atoms-$\atomP$} for $\refinement^\gamma$ we have $\kStateT_\gamma \in \kValuation(\atomP)$ if and only if $\kStateS[\gamma] \in \kValuation[\gamma](\atomP)$.
                By construction $\kStateS[\gamma] \in \kValuation[\gamma](\atomP)$ if and only if $\kStateSP_\gamma \in \kValuationP(\atomP)$.
            \item[forth-$\agentC$]
                Suppose that $\agentC = \agentA$.
                Let $\kStateU \in \kSuccessorsA{\kStateT_\gamma}$.
                By hypothesis $\kStateT_\gamma \in \kSuccessorsA{\kStateS}$ and by the Euclideaness of $\kModel$ we have that $\kStateU \in \kSuccessorsA{\kStateS}$.
                By hypothesis $(\kStateU, \kStateSP_{\kStateU}) \in \refinement^{\kStateU}$.
                By construction $\kStateSP_{\kStateU} \in \kSuccessorsPA{\kStateSP_\gamma}$ and $(\kStateU, \kStateSP_{\kStateU}) \in \refinement^{\kStateU} \subseteq \refinement$.

                Suppose that $\agentC \neq \agentA$.
                Let $\kStateU \in \kSuccessorsC{\kStateT_\gamma}$.
                By hypothesis $(\kStateT_\gamma, \kStateS[\gamma]) \in \refinement^\gamma$.
                By {\bf forth-$\agentC$} for $\refinement^\gamma$ there exists $\kStateU[\gamma] \in \kSuccessorsC[\gamma]{\kStateS[\gamma]}$ such that $(\kStateU, \kStateU[\gamma]) \in \refinement^\gamma$.
                By construction $\kSuccessorsPC{\kStateSP_\gamma} = \kSuccessorsC[\gamma]{\kStateS[\gamma]}$.
                Then $\kStateU[\gamma] \in \kSuccessorsPC{\kStateSP_\gamma}$ and $(\kStateU, \kStateU[\gamma]) \in \refinement$.
            \item[back-$\agentB$]
                Suppose that $\agentB = \agentA$.
                Let $\kStateSP_{\gamma'} \in \kSuccessorsPA{\kStateSP_\gamma}$ where $\gamma' \in \Gamma_\agentA$.
                By hypothesis $\kStateT_{\gamma}, \kStateT_{\gamma'} \in \kSuccessorsA{\kStateS}$, and by the Euclideaness of $\kModel$ we have that $\kStateT_{\gamma'} \in \kSuccessorsA{\kStateT_\gamma}$.
                By construction $(\kStateT_{\gamma'}, \kStateSP_{\gamma'}) \in \refinement$.
                Let $\kStateSP_{\kStateT} \in \kSuccessorsPA{\kStateSP_\gamma}$ where $\kStateT \in \kSuccessorsA{\kStateS}$.
                By hypothesis $\kStateT, \kStateT_{\gamma} \in \kSuccessorsA{\kStateS}$, and by the Euclideaness of $\kModel$ we have that $\kStateT_{\gamma'} \in \kSuccessorsA{\kStateT_\gamma}$.
                By construction $(\kStateT, \kStateSP_{\kStateT}) \in \refinement$.

                Suppose that $\agentB \neq \agentA$.
                Let $\kStateT[\gamma] \in \kSuccessorsPA{\kStateSP_\gamma}$.
                By construction $(\kStateT_\gamma, \kStateS[\gamma]) \in \refinement^\gamma$.
                By {\bf back-$\agentB$} for $\refinement^\gamma$ there exists $\kStateU \in \kSuccessorsB{\kStateT_\gamma}$ such that $(\kStateU, \kStateT[\gamma]) \in \refinement^\gamma$.
                By construction $(\kStateU, \kStateT[\gamma]) \in \refinement$.
        \end{description}
    \item[Case $(\kStateT, \kStateSP_{\kStateT}) \in \refinement$ where $\kStateT \in \kSuccessorsA{\kStateT}$:]
        \hfill
        \begin{description}
            \item[atoms-$\atomP$] 
                By hypothesis $(\kStateT, \kStateS[\kStateT]) \in \refinement^{\kStateT}$.
                By {\bf atoms-$\atomP$} for $\refinement^{\kStateT}$ we have $\kStateT \in \kValuation(\atomP)$ if and only if $\kStateS[\kStateT] \in \kValuation[\kStateT](\atomP)$.
                By construction $\kStateS[\kStateT] \in \kValuation[\kStateT](\atomP)$ if and only if $\kStateSP_{\kStateT} \in \kValuationP(\atomP)$.
            \item[forth-$\agentC$]
                Suppose that $\agentC = \agentA$.
                Let $\kStateU \in \kSuccessorsA{\kStateT}$.
                By hypothesis $\kStateT \in \kSuccessorsA{\kStateS}$ and by the Euclideaness of $\kModel$ we have that $\kStateU \in \kSuccessorsA{\kStateS}$.
                By hypothesis $(\kStateU, \kStateSP_{\kStateU}) \in \refinement^{\kStateU}$.
                By construction $\kStateSP_{\kStateU} \in \kSuccessorsPA{\kStateSP_{\kStateT}}$ and $(\kStateU, \kStateSP_{\kStateU}) \in \refinement^{\kStateU} \subseteq \refinement$.

                Suppose that $\agentC \neq \agentA$.
                Let $\kStateU \in \kSuccessorsC{\kStateT}$.
                By hypothesis $(\kStateT, \kStateS[\kStateT]) \in \refinement^{\kStateT}$.
                By {\bf forth-$\agentC$} for $\refinement^{\kStateT}$ there exists $\kStateU[\kStateT] \in \kSuccessorsC[\kStateT]{\kStateS[\kStateT]}$ such that $(\kStateU, \kStateU[\kStateT]) \in \refinement^{\kStateT}$.
                By construction $\kSuccessorsPC{\kStateSP_{\kStateT}} = \kSuccessorsC[\kStateT]{\kStateS[\kStateT]}$.
                Then $\kStateU[\kStateT] \in \kSuccessorsPC{\kStateSP_{\kStateT}}$ and $(\kStateU, \kStateU[\kStateT]) \in \refinement$.
            \item[back-$\agentB$]
                Suppose that $\agentB = \agentA$.
                Let $\kStateSP_{\gamma} \in \kSuccessorsPA{\kStateSP_{\kStateT}}$ where $\gamma \in \Gamma_\agentA$.
                By hypothesis $\kStateT, \kStateT_{\gamma} \in \kSuccessorsA{\kStateS}$, and by the Euclideaness of $\kModel$ we have that $\kStateT_{\gamma} \in \kSuccessorsA{\kStateT}$.
                By construction $(\kStateT_{\gamma}, \kStateSP_{\gamma}) \in \refinement$.
                Let $\kStateSP_{\kStateU} \in \kSuccessorsPA{\kStateSP_{\kStateT}}$ where $\kStateU \in \kSuccessorsA{\kStateS}$.
                By hypothesis $\kStateT, \kStateU \in \kSuccessorsA{\kStateS}$, and by the Euclideaness of $\kModel$ we have that $\kStateU \in \kSuccessorsA{\kStateT}$.
                By construction $(\kStateU, \kStateSP_{\kStateU}) \in \refinement$.
                Suppose that $\agentB \neq \agentA$.
                Let $\kStateU[\kStateT] \in \kSuccessorsPA{\kStateSP_{\kStateT}}$.
                By construction $(\kStateT, \kStateS[\kStateT]) \in \refinement^{\kStateT}$.
                By {\bf back-$\agentB$} for $\refinement^{\kStateT}$ there exists $\kStateU \in \kSuccessorsB{\kStateT}$ such that $(\kStateU, \kStateU[\kStateT]) \in \refinement^{\kStateT}$.
                By construction $(\kStateU, \kStateU[\kStateT]) \in \refinement$.
        \end{description}
    \item[Case $(\kStateT, \kStateT) \in \refinement$ where $\kStateT \in \kStates$:]
        \hfill
        \begin{description}
            \item[atoms-$\atomP$] 
                By construction $\kStateT \in \kValuation(\atomP)$ if and only if $\kStateT \in \kValuationP(\atomP)$.
            \item[forth-$\agentC$]
                Let $\kStateU \in \kSuccessorsC{\kStateT}$.
                By construction $\kSuccessorsPC{\kStateT} = \kSuccessorsC{\kStateT}$.
                Then $\kStateU \in \kSuccessorsPC{\kStateT}$ and by construction $(\kStateU, \kStateU) \in \refinement$.
            \item[back-$\agentB$]
                Let $\kStateU \in \kSuccessorsPB{\kStateT}$.
                By construction $\kSuccessorsPB{\kStateT} = \kSuccessorsB{\kStateT}$.
                Then $\kStateU \in \kSuccessorsB{\kStateT}$ and by construction $(\kStateU, \kStateU) \in \refinement$.
        \end{description}
    \item[{Case $(\kStateU, \kStateU[\gamma]) \in \refinement^\gamma \subseteq \refinement$ where $\gamma \in \Gamma_\agentA$:}]
        \hfill
        \begin{description}
            \item[atoms-$\atomP$] 
                By {\bf atoms-$\atomP$} for $\refinement^\gamma$ we have $\kStateU \in \kValuation(\atomP)$ if and only if $\kStateU[\gamma] \in \kValuation[\gamma](\atomP)$.
                By construction $\kStateU[\gamma] \in \kValuation[\gamma](\atomP)$ if and only if $\kStateU[\gamma] \in \kValuationP(\atomP)$.
            \item[forth-$\agentC$]
                Let $\kStateV \in \kSuccessorsC{\kStateU}$.
                By {\bf forth-$\agentC$} for $\refinement^\gamma$ there exists $\kStateV[\gamma] \in \kSuccessorsC[\gamma]{\kStateU[\gamma]}$ such that $(\kStateV, \kStateV[\gamma]) \in \refinement^\gamma \subseteq \refinement$.
                By construction $\kSuccessorsPC{\kStateU[\gamma]} = \kSuccessorsC[\gamma]{\kStateU[\gamma]}$.
                Then $\kStateV[\gamma] \in \kSuccessorsPC{\kStateU[\gamma]}$ and $(\kStateV, \kStateV[\gamma]) \in \refinement$.
            \item[back-$\agentB$]
                Let $\kStateV[\gamma] \in \kSuccessorsPB{\kStateU[\gamma]}$.
                By construction $\kStateV[\gamma] \in \kSuccessorsB[\gamma]{\kStateU[\gamma]}$.
                By {\bf back-$\agentB$} for $\refinement^{\gamma}$ there exists $\kStateV \in \kSuccessorsB{\kStateU}$ such that $(\kStateV, \kStateV[\gamma]) \in \refinement^{\gamma}$.
                Then $(\kStateV, \kStateV[\gamma]) \in \refinement$.
        \end{description}
    \item[{Case $(\kStateU, \kStateU[\kStateT]) \in \refinement^{\kStateT} \subseteq \refinement$ where $\kStateT \in \kSuccessorsA{\kStateS}$:}]
        \hfill
        \begin{description}
            \item[atoms-$\atomP$] 
                By {\bf atoms-$\atomP$} for $\refinement^{\kStateT}$ we have $\kStateU \in \kValuation(\atomP)$ if and only if $\kStateU[\kStateT] \in \kValuation[\kStateT](\atomP)$.
                By construction $\kStateU[\kStateT] \in \kValuation[\kStateT](\atomP)$ if and only if $\kStateU[\kStateT] \in \kValuationP(\atomP)$.
            \item[forth-$\agentC$]
                Let $\kStateV \in \kSuccessorsC{\kStateU}$.
                By {\bf forth-$\agentC$} for $\refinement^{\kStateT}$ there exists $\kStateV[\kStateT] \in \kSuccessorsC[\kStateT]{\kStateU[\kStateT]}$ such that $(\kStateV, \kStateV[\kStateT]) \in \refinement^{\kStateT} \subseteq \refinement$.
                By construction $\kSuccessorsPC{\kStateU[\kStateT]} = \kSuccessorsC[\kStateT]{\kStateU[\kStateT]}$.
                Then $\kStateV[\kStateT] \in \kSuccessorsPC{\kStateU[\kStateT]}$ and $(\kStateV, \kStateV[\kStateT]) \in \refinement$.
            \item[back-$\agentB$]
                Let $\kStateV[\kStateT] \in \kSuccessorsPB{\kStateU[\kStateT]}$.
                By construction $\kStateV[\kStateT] \in \kSuccessorsB[\kStateT]{\kStateU[\kStateT]}$.
                By {\bf back-$\agentB$} for $\refinement^{\kStateT}$ there exists $\kStateV \in \kSuccessorsB{\kStateU}$ such that $(\kStateV, \kStateV[\kStateT]) \in \refinement^{\kStateT}$.
                Then $(\kStateV, \kStateV[\kStateT]) \in \refinement$.
        \end{description}
\end{description}

Therefore $\refinement$ is a $\agentsB$-refinement and as $(\kStateS, \kStateSP) \in \refinement$ we have that $\kPModel{\kStateS} \simulatesBs \kPModelP{\kStateSP}$.

Let $\gamma \in \Gamma_\agentA$.
We note for every $\kStateT[\gamma] \in \kStates[\gamma]$ that $\kPModelP{\kStateT[\gamma]} \bisimilar \kPModel[\gamma]{\kStateT[\gamma]}$, as by construction the valuations and successor states of states from $\kModel[\gamma]$ are left unchanged in $\kModelP$.
So we have that $\kPModelP{\kStateSP_\gamma} \bisimilar[\agents \setminus \{\agentA\}] \kPModel[\gamma]{\kStateS[\gamma]}$.
As $\gamma$ is a $(\agents \setminus \{\agentA\})$-restricted modal formula and $\kPModel[\gamma]{\kStateS[\gamma]} \entails \gamma$ then by Lemma~\ref{b-restricted-invariance} we have that $\kPModelP{\kStateSP_\gamma} \entails \gamma$.
Likewise for every $\kStateT \in \kSuccessorsA{\kStateS}$ we have that $\kPModel{\kStateSP_{\kStateT}} \entails \bigvee_{\gamma \in \Gamma_\agentA} \gamma$.
Then $\kPModelP{\kStateSP} \entails \coversA \Gamma_\agentA$ follows from the same reasoning as in the proof of soundness of {\bf RK} in Lemma~\ref{rml-k-rk}.

Therefore $\kPModel{\kStateS} \entails \somerefsBs \coversA \Gamma_\agentA$.
\end{proof}

Again we use similar reasoning to show that the axiom {\bf RComm} from \axiomRmlKD{} is sound.
Recall that the axiom {\bf RComm} takes the form of $\proves \somerefsBs \coversA \Gamma_\agentA \iff \coversA \{\somerefsBs \gamma \mid \gamma \in \Gamma_\agentA\}$ where $\agentsB \subseteq \agents$, $\agentA \notin \agentsB$, and $\Gamma_\agentA \subseteq \langRml$ is a non-empty, finite set of $(\agents \setminus \{\agentA\})$-restricted modal formulas.
This accounts for the additional requirement in \logicRmlKD{} that refinements must be serial.
Similar to {\bf RK45} and {\bf RKD45}, the difference between {\bf RComm} in \axiomRmlKFF{} and {\bf RComm} in \axiomRmlKD{} is the requirement that $\Gamma_\agentA$ be a non-empty set of formulas, which accounts for the additional requirement in \logicRmlKD{} that refinements must be serial.

\begin{lemma}\label{rml-kd45-rcomm}
The axiom {\bf RComm} from the axiomatisation \axiomRmlKD{} is sound with respect to the semantics of the logic \logicRmlKD{}.
\end{lemma}

\begin{proof}
The proof of Lemma~\ref{rml-k45-rcomm} applies with minor considerations in the setting of \logicRmlKD{}.
For the left-to-right direction the semantics of \logicRmlKD{} require that $\kPModel{\kStateS}, \kPModelP{\kStateSP} \in \classKD$ instead of \classKFF{}, but otherwise the reasoning is the same.
For the right-to-left direction the semantics of \logicRmlKD{} require that $\kPModel{\kStateS} \in \classKD$, for every $\gamma \in \Gamma_\agentA$ that $\kPModel[\gamma]{\kStateS[\gamma]} \in \classKD$, and for every $\kStateT \in \kSuccessorsA{\kStateS}$ that $\kPModel[\kStateT]{\kStateS[\kStateT]} \in \classKD$.
We must additionally show here that the constructed model $\kPModelP{\kStateSP} \in \classKD$, but this is trivial given that $\Gamma_\agentA$ is non-empty (ensuring seriality at $\kPModelP{\kStateSP}$), for every $\gamma \in \Gamma_\agentA$ we have $\kPModel[\gamma]{\kStateS[\gamma]} \in \classKD$, and for every $\kStateT \in \kSuccessorsA{\kStateS}$ that $\kPModel[\kStateT]{\kStateS[\kStateT]} \in \classKD$ (ensuring seriality elsewhere).
\end{proof}

We next show that the axiom {\bf RDist} is sound.
Recall that the axiom {\bf RDist} takes the form of $\proves \somerefsBs \bigwedge_{\agentC \in \agentsC} \coversC \Gamma_\agentC \iff \bigwedge_{\agentC \in \agentsC} \somerefsBs \coversC \Gamma_\agentC$ where $\agentsB, \agentsC \subseteq \agents$ and for every $\agentC \in \agentsC$: $\Gamma_\agentC \subseteq \langRml$ is a finite set of $(\agents \setminus \{\agentA\})$-restricted modal formulas.

\begin{lemma}\label{rml-k45-rdist}
The axiom {\bf RDist} from the axiomatisation \axiomRmlKFF{} is sound with respect to the semantics of the logic \logicRmlKFF{}.
\end{lemma}

\begin{proof}
    ($\Rightarrow$) Let $\kPModel{\kStateS} \in \classKFF$ be a pointed Kripke model such that $\kPModel{\kStateS} \entails \somerefsBs ( \bigwedge_{\agentC \in \agentsC} \coversC \Gamma_\agentC )$.
    Then we show that $\kPModel{\kStateS} \entails \bigwedge_{\agentC \in \agentsC} \somerefsBs \coversC \Gamma_\agentC$ using the same reasoning as in the proof of soundness of {\bf RDist} from \axiomRmlK{} in Lemma~\ref{rml-k-rcomm}.

($\Leftarrow$) Let $\kPModelAndTuple{\kStateS} \in \classKFF$ be a pointed Kripke model such that $\kPModel{\kStateS} \entails \bigwedge_{\agentC \in \agentsC} \somerefsBs \coversC \Gamma_\agentC$.
For every $\agentC \in \agentsC$ there exists $\kPModel[\agentC]{\kStateS[\agentC]} \in \classKFF$ such that $\kPModel{\kStateS} \simulatesBs \kPModel[\agentC]{\kStateS[\agentC]}$ and $\kPModel[\agentC]{\kStateS[\agentC]} \entails \coversC \Gamma_\agentC$.
Then we show that $\kPModel{\kStateS} \entails \somerefsBs ( \bigwedge_{\agentC \in \agentsC} \coversC \Gamma_\agentC)$ using the same reasoning as in the proof of soundness of {\bf RDist} from \axiomRmlK{} in Lemma~\ref{rml-k-rcomm}.
We note that since each of the refinements $\kPModel[\agentC]{\kStateS[\agentC]}$ are \classKFF{} models then the construction used in Lemma~\ref{rml-k-rcomm} will produce a \classKFF{} model as required.
\end{proof}

Yet again we use similar reasoning to show that the axiom {\bf RDist} from \axiomRmlKD{} is sound.
Recall that the axiom {\bf RDist} takes the form of $\proves \somerefsBs \bigwedge_{\agentC \in \agentsC} \coversC \Gamma_\agentC \iff \bigwedge_{\agentC \in \agentsC} \somerefsBs \coversC \Gamma_\agentC$ where $\agentsB, \agentsC \subseteq \agents$ and for every $\agentC \in \agentsC$: $\Gamma_\agentC \subseteq \langRml$ is a non-empty, finite set of $(\agents \setminus \{\agentA\})$-restricted modal formulas.

\begin{lemma}\label{rml-kd45-rdist}
The axiom {\bf RDist} from the axiomatisation \axiomRmlKFF{} is sound with respect to the semantics of the logic \logicRmlKFF{}.
\end{lemma}

\begin{proof}
The proof of Lemma~\ref{rml-k45-rdist} applies with minor considerations in the setting of \logicRmlKD{}, simply replacing occurrences of \classKFF{} with \classKD{}.
\end{proof}

Finally we show that the axiomatisations \axiomRmlKFF{} and \axiomRmlKD{} are sound.

\begin{lemma}\label{rml-k45-sound}
The axiomatisation \axiomRmlKFF{} is sound with respect to the semantics of the logic \logicRmlKFF{}.
\end{lemma}

\begin{proof}
The soundness of the axioms and rules of \axiomKFF{} with respect to the semantics of the logic \logicRmlKFF{} follow from the same reasoning that they are sound in the logic \logicKFF{}.
The soundness of {\bf R}, {\bf RP} and {\bf NecR} follow from Proposition~\ref{rml-validities}.
The soundness of {\bf RK45}, {\bf RComm} and {\bf RDist} were shown in the previous lemmas.
\end{proof}

\begin{lemma}\label{rml-kd45-sound}
The axiomatisation \axiomRmlKD{} is sound with respect to the semantics of the logic \logicRmlKD{}.
\end{lemma}

\begin{proof}
The soundness of the axioms and rules of \axiomKD{} with respect to the semantics of the logic \logicRmlKD{} follow from the same reasoning that they are sound in the logic \logicKD{}.
The soundness of {\bf R}, {\bf RP} and {\bf NecR} follow from Proposition~\ref{rml-validities}.
The soundness of {\bf RKD45}, {\bf RComm} and {\bf RDist} were shown in the previous lemmas.
\end{proof}

\section{Completeness}\label{rml-kd45-completeness}

In this section we show that the axiomatisations \axiomRmlKFF{} and \axiomRmlKD{} are complete with respect to the semantics of the logics \logicRmlKFF{} and \axiomRmlKD{} respectively.
As with \axiomRmlK{}, we show that \axiomRmlKFF{} and \axiomRmlKD{} are complete by demonstrating a provably correct translation from formulas of \langRml{} to the underlying modal language \langMl{}.
As a consequence of this provably correct translation we also have that \logicRmlKFF{} and \logicRmlKD{} are expressively equivalent to \logicKFF{} and \logicRmlKD{} respectively, and that \logicRmlKFF{} and \logicRmlKD{} are compact and decidable, via the compactness and decidability of \logicKFF{} and \logicKD{}.

Similar to \axiomRmlK{} we rely on a normal form for modal logics for our provably correct translation, which we call alternating disjunctive normal form.
Alternating disjunctive normal form is a modification of the disjunctive normal form used for \axiomRmlK{}, that prohibits the direct nesting of modalities from the same agent.
Unlike the $\agentsB$-restricted modal formulas introduced earlier, this restriction applies throughout the formula, rather than only at the top-level of modalities.
This ensures that when we repeatedly apply the axioms {\bf RK45}, {\bf RKD45}, {\bf RComm}, and {\bf RDist} in our provably correct translation to push refinement quantifiers inwards, they are only applied to formulas where $\agents$-cover operators are applied to sets of $(\agents \setminus \{\agentA\})$-restricted formulas.

We first define our normal form, called alternating disjunctive normal form.

\begin{definition}[Alternating disjunctive normal form]
Let $\agentsB \subseteq \agents$ be a set of agents.
A formula in {\em $\agentsB$-alternating disjunctive normal form} is inductively defined as:
$$
\phi ::= \pi \land \bigwedge_{\agentC \in \agentsC} \coverC \Gamma_\agentC \mid \phi \lor \phi
$$
where $\pi \in \langPl$, $\agentsC \subseteq \agentsB$, and for every $\agentC \in \agentsC$, $\Gamma_\agentC$ is a finite set of formulas in $(\agents \setminus \{\agentC\})$-alternating disjunctive normal form.
\end{definition}

We show that every modal formula is equivalent to a formula in alternating disjunctive normal form, under the semantics of \logicKFF{} and \logicKD{}. 

\begin{lemma}\label{adnf-equivalent}
Let $\agentsB \subseteq \agents$ be a set of agents.
Every $\agentsB$-restricted modal formula is equivalent to a formula in $\agentsB$-alternating cover disjunctive normal form under the semantics of logics \logicKFF{} and \logicKD{}.
\end{lemma}

\begin{proof}
Let $\phi \in \langMl$ be a $\agentsB$-restricted modal formula.
Without loss of generality, by Lemma~\ref{dnf-equivalent} we may assume that $\phi$ is in disjunctive normal form.
We prove by induction on the modal depth of $\phi$ and the structure of $\phi$ that it is equivalent to a formula in $\agentsB$-alternating disjunctive normal form.

Suppose that $d(\phi) = 0$. 
Then $\phi$ is already in $\agentsB$-alternating disjunctive normal form.

Suppose that $d(\phi) > 0$ and $\phi = \psi \lor \chi$ for $\psi, \chi \in \langMl$ in disjunctive normal form.
By the induction hypothesis there exists $\psi', \chi' \in \langMl$ in $\agentsB$-alternating disjunctive normal form such that $\entails \psi \iff \psi'$ and $\entails \chi \iff \chi'$.
Then $\psi' \lor \chi'$ is in $\agentsB$-alternating disjunctive normal form and $\entails (\psi \lor \chi) \iff (\psi' \lor \chi')$.

Suppose that $d(\phi) > 0$ and $\phi = \pi \land \bigwedge_{\agentC \in \agentsC} \coverC \Gamma_\agentC$.
By the induction hypothesis for every $\agentC \in \agentsC$, $\gamma \in \Gamma_\agentC$ there exists $\gamma' \in \langMl$ in alternating disjunctive normal form such that $\entails \gamma \iff \gamma'$.
For every $\agentC \in \agentsC$, let $\Gamma'_\agentC = \{\gamma' \mid \gamma \in \Gamma_\agentC\}$.
Let $\phi' = \pi \land \bigwedge_{\agentC \in \agentsC} \coverC \Gamma'_\agentC$.
Then $\entails \phi \iff \phi'$.
Here we note that for every $\agentC \in \agentC$, $\gamma' \in \Gamma'_\agentC$ may contain $\coversC$ modalities at the top level, and so we use some equivalences to correct this.
We pull the disjunctions within each cover operator up one level using the following equivalence:
$$
\entails \coversC (\{\psi \lor \chi\} \cup \Gamma) \iff \coversC (\{\psi\} \cup \Gamma) \lor \coversC (\{\chi\} \cup \Gamma) \lor \coversC (\{\psi, \chi\} \cup \Gamma)
$$
Once the disjunctions within the cover operators are removed, we pull the nested cover operators of the same agent up one level using the following equivalence:
$$
\entails \coversC (\{\psi \land \coversC \Gamma'\} \cup \Gamma) \iff \coversC (\{\psi\} \cup \Gamma) \land \coversC \Gamma'
$$
Once these equivalences have been applied as many times as possible, the resulting formula will have no cover modalities nested directly with a cover operator of the same agent.
We can then translate the resulting formula into $\agentsB$-alternating disjunctive normal form using the same method for disjunctive normal form, noting that the equivalences used in the proof of Lemma~\ref{dnf-equivalent} will preserve the alternating structure of the formula.
\end{proof}

We note that we have shown a semantic equivalence between \langMl{} formulas and formulas in alternating disjunctive normal form.
As \axiomKFF{} is a sound and complete axiomatisation for \logicKFF{} then this is also a provable equivalence in \axiomKFF{}, and as the axioms and rules of \axiomKFF{} are included in the axiomatisation \axiomRmlKFF{} this is also a provable equivalence in \axiomRmlKFF{}.
Likewise this is a provable equivalence in \axiomRmlKD{}.

Given the disjunctive normal form, we will show that the reduction axioms of \axiomRmlKFF{} and \axiomRmlKD{} may be applied to formulas in disjunctive normal form in order to give a provably correct translation.
We first show some useful theorems in \axiomRmlKFF{} and \axiomRmlKD{}.

\begin{lemma}\label{rml-k45-theorems}
The following are theorems of \axiomRmlKFF{}:
\begin{align}
    \proves & \allrefsBs (\phi \land \psi) \iff (\allrefsBs \phi \land \allrefsBs \psi) \label{rml-k45-and}\\
    \proves & \somerefsBs (\phi \lor \psi) \iff (\somerefsBs \phi \lor \somerefsBs \psi) \label{rml-k45-or}\\
    \proves & \somerefsBs (\phi \land \psi) \implies (\somerefsBs \phi \land \somerefsBs \psi) \label{rml-k45-d-and}\\
    \proves & (\allrefsBs \phi \land \somerefsBs \psi) \implies \somerefsBs (\phi \land \psi) \label{rml-k45-db-and}\\
    \proves & (\pi \land \somerefsBs \psi) \iff \somerefsBs (\pi \land \psi) \label{rml-k45-pd-and}\\
    \proves & \displaystyle \somerefsBs (\pi \land \bigwedge_{\agentC \in \agentsC} \coverC \Gamma_\agentC) \iff \nonumber\\
            & \displaystyle \quad
            (
            \pi \land
            \bigwedge_{\agentC \in \agentsC \cap \agentsB} \bigwedge_{\gamma \in \Gamma_\agentC} \possibleC \somerefsBs \gamma \land
            \bigwedge_{\agentC \in \agentsC \setminus \agentsB} \coversC \{\somerefsBs \gamma \mid \gamma \in \Gamma_\agentC\} 
            ) \label{rml-k45-cover}
\end{align}
where $\phi, \psi \in \langRml$, $\pi \in \langPl$, $\agentA \in \agents$, $\agentsB, \agentsC \subseteq \agents$, and for every $\agentA \in \agents$: $\Gamma_\agentA$ is a finite set of $(\agents \setminus \{\agentA\})$-restricted modal formulas.
\end{lemma}

\begin{proof}
These theorems can be shown using essentially the same proofs given for Lemma~\ref{rml-k-theorems} for similar theorems in \axiomRmlK{}.
The only consideration that must be made for \axiomRmlKFF{} is for theorem (\ref{rml-k45-cover}) where we must use {\bf RK45} instead of {\bf RK}, and we note that each set $\Gamma_\agentA$ must be a set of $(\agents \setminus \{\agentA\})$-restricted modal formulas in order for {\bf RK45}, {\bf RComm}, and {\bf RDist} to be applicable, but that requirement is satisfied by hypothesis.
\end{proof}

We can now clearly recognise that equivalences (\ref{rml-k45-or}) and (\ref{rml-k45-cover}) are reduction axioms that can be used to push refinement quantifiers past propositional connectives and modalities in formulas in alternating disjunctive normal form.
We compare this result to Lemma~\ref{rml-k-theorems} where we had similar reduction axioms for the disjunctive normal form.

We have similar theorems for \axiomRmlKD{}.

\begin{lemma}\label{rml-kd45-theorems}
The following are theorems of \axiomRmlKD{}:
\begin{align}
    \proves & \allrefsBs (\phi \land \psi) \iff (\allrefsBs \phi \land \allrefsBs \psi) \label{rml-kd45-and}\\
    \proves & \somerefsBs (\phi \lor \psi) \iff (\somerefsBs \phi \lor \somerefsBs \psi) \label{rml-kd45-or}\\
    \proves & \somerefsBs (\phi \land \psi) \implies (\somerefsBs \phi \land \somerefsBs \psi) \label{rml-kd45-d-and}\\
    \proves & (\allrefsBs \phi \land \somerefsBs \psi) \implies \somerefsBs (\phi \land \psi) \label{rml-kd45-db-and}\\
    \proves & (\pi \land \somerefsBs \psi) \iff \somerefsBs (\pi \land \psi) \label{rml-kd45-pd-and}\\
    \proves & \lnot \somerefsBs \coversA \emptyset \label{rml-kd45-cover-empty}\\
    \proves & \displaystyle \somerefsBs (\pi \land \bigwedge_{\agentC \in \agentsC} \coverC \Gamma_\agentC) \iff \nonumber\\
            & \displaystyle \quad
            (
            \pi \land
            \bigwedge_{\agentC \in \agentsC \cap \agentsB} \bigwedge_{\gamma \in \Gamma_\agentC} \possibleC \somerefsBs \gamma \land
            \bigwedge_{\agentC \in \agentsC \setminus \agentsB} \coversC \{\somerefsBs \gamma \mid \gamma \in \Gamma_\agentC\} 
            ) \label{rml-kd45-cover}
\end{align}
where $\phi, \psi \in \langRml$, $\pi \in \langPl$, $\agentA \in \agents$, $\agentsB, \agentsC \subseteq \agents$, and for every $\agentA \in \agents$: $\Gamma_\agentA$ is a finite set of $(\agents \setminus \{\agentA\})$-restricted modal formulas.
\end{lemma}

\begin{proof}
As above, with the exception of (\ref{rml-kd45-cover-empty}) these theorems can be shown using essentially the same proofs given for Lemma~\ref{rml-k-theorems} for similar theorems in \axiomRmlK{}.
The only consideration that must be made for \axiomRmlKD{} is for theorem (\ref{rml-kd45-cover}) where we must use {\bf RDK45} instead of {\bf RK}, and we note that each set $\Gamma_\agentA$ must be a non-empty set of $(\agents \setminus \{\agentA\})$-restricted modal formulas in order for {\bf RK45}, {\bf RComm}, and {\bf RDist} to be applicable, but that requirement is satisfied by hypothesis.

We show that $\proves \lnot \somerefsBs \coversA \emptyset$.
$$
\begin{array}{ll}
    \proves \top & {\bf P}\\
    \proves \necessaryA \top & {\bf NecK}\\
    \proves \lnot \possibleA \bot & \text{Defn. of $\possibleA$}\\
    \proves \necessaryA \bot \implies \possibleA \bot & {\bf D}\\
    \proves \lnot \necessaryA \bot & {\bf P}\\
    \proves \lnot \coversA \emptyset & \text{Defn. of $\coversA$}\\
    \proves \allrefsBs \lnot \coversA \emptyset & {\bf NecR}\\
    \proves \lnot \somerefsBs \coversA \emptyset & \text{Defn. of $\somerefsBs$}
\end{array}
$$
\end{proof}

As above we can recognise that equivalences (\ref{rml-kd45-or}) and (\ref{rml-kd45-cover}) are reduction axioms that can be used to push refinement quantifiers past propositional connectives and modalities in formulas in alternating disjunctive normal form.
We note that the equivalence (\ref{rml-kd45-cover}) only applies to formulas where the cover operators are applied to non-empty sets of formulas, a condition that the alternating disjunctive normal form does not guarantee.
However we can get around this limitation by using theorem \ref{rml-kd45-cover-empty}, noting due to the seriality of \classKD{} that cover operators applied to empty sets of formulas are always false, and so a conjunction including such a cover operator is also false.

Before we give our provably correct translations we give two lemmas each for \axiomRmlKFF{} and \axiomRmlKD{}.

First we note that every \axiomKFF{} theorem is an \axiomRmlKFF{} theorem and every \axiomKD{} theorem is an \axiomRmlKD{} theorem.

\begin{lemma}\label{rml-k45-ml-provability}
Let $\phi \in \langMl$ be a modal formula.
If $\proves_\axiomKFF \phi$ then $\proves_\axiomRmlKFF \phi$.
\end{lemma}

\begin{lemma}\label{rml-kd45-ml-provability}
Let $\phi \in \langMl$ be a modal formula.
If $\proves_\axiomKD \phi$ then $\proves_\axiomRmlKD \phi$.
\end{lemma}

These lemmas follow from essentially the same reasoning as used to show Lemma~\ref{rml-k-ml-provability} for \axiomRmlK{}.

Secondly we show that \axiomRmlKFF{} and \axiomRmlKD{} satisfy substitution of equivalents.

\begin{lemma}\label{rml-k45-substitution-equivalents}
Let $\phi, \psi, \chi \in \langRml$ be formulas and let $\atomP \in \atoms$ be a propositional atom.
If $\proves_\axiomRmlKFF \psi \iff \chi$ then $\proves_\axiomRmlKFF \phi[\psi\backslash\atomP] \iff \phi[\chi\backslash\atomP]$.
\end{lemma}

\begin{lemma}\label{rml-kd45-substitution-equivalents}
Let $\phi, \psi, \chi \in \langRml$ be formulas and let $\atomP \in \atoms$ be a propositional atom.
If $\proves_\axiomRmlKD \psi \iff \chi$ then $\proves_\axiomRmlKD \phi[\psi\backslash\atomP] \iff \phi[\chi\backslash\atomP]$.
\end{lemma}

These lemmas follow from essentially the same reasoning as used to show Lemma~\ref{rml-k-substitution-equivalents} for \axiomRmlK{}.

We now show that the reduction axioms of \logicRmlKFF{} and \logicRmlKD{} admit provably correct translations from \langRml{} to \langMl{}.

\begin{lemma}\label{rml-k45-ml-equivalent}
Every refinement modal formula is provably equivalent to a modal formula using the axiomatisation \axiomRmlKFF{}.
\end{lemma}

\begin{proof}
We use essentially the same reasoning as in Lemma~\ref{rml-k-ml-equivalent} for \axiomRmlK{}.
We convert subformulas to alternating disjunctive normal form instead of disjunctive normal form, which ensures that $\coversA$~operators are only applied to sets of $(\agents \setminus \{\agentA\})$-restricted modal formulas, allowing the equivalences from Lemma~\ref{rml-k45-theorems} to be applied inductively.
\end{proof}

\begin{lemma}\label{rml-kd45-ml-equivalent}
Every refinement modal formula is provably equivalent to a modal formula using the axiomatisation \axiomRmlKFF{}.
\end{lemma}

\begin{proof}
We use essentially the same reasoning as in Lemma~\ref{rml-k-ml-equivalent} for \axiomRmlK{}.
As in Lemma~\ref{rml-k45-ml-equivalent} above, we convert subformulas to alternating disjunctive normal form instead of disjunctive normal form, which ensures that $\coversA$~operators are only applied to sets of $(\agents \setminus \{\agentA\})$-restricted modal formulas.
However the corresponding equivalences from Lemma~\ref{rml-kd45-theorems} also require that $\coversA$~operators only be applied to non-empty sets of formulas.
We satisfy this requirement by using equivalence (\ref{rml-kd45-cover-empty}) to replace $\coversA$~operators applied to empty sets of formulas with the propositional formula $\bot$, so a subformula of the form $\pi \land \coversA \Gamma_\agentA \land \bigwedge_{\agentC \in \agentsC \setminus \{\agentA\}} \coversC \Gamma_\agentC$ becomes $(\pi \land \bot) \land \bigwedge_{\agentC \in \agentsC \setminus \{\agentA\}} \coversC \Gamma_\agentC$, or simply $\bot$.
This allows the equivalences from Lemma~\ref{rml-kd45-theorems} to be applied inductively.
\end{proof}

Given the provably correct translation we have that \axiomRmlKFF{} and \axiomRmlKD{} are sound and complete.

\begin{theorem}\label{rml-k45-sound-complete}
The axiomatisation \axiomRmlKFF{} is sound and strongly complete with respect to the semantics of the logic \logicRmlKFF{}.
\end{theorem}

\begin{proof}
Soundness is shown in Lemma~\ref{rml-k45-sound}.
Strong completeness follows from the same reasoning as in Lemma~\ref{rml-k-sound-complete} for \axiomRmlK{}, using the provably correct translation from Lemma~\ref{rml-k45-ml-equivalent}.
\end{proof}

\begin{theorem}\label{rml-kd45-sound-complete}
The axiomatisation \axiomRmlKFF{} is sound and strongly complete with respect to the semantics of the logic \logicRmlKD{}.
\end{theorem}

\begin{proof}
Soundness is shown in Lemma~\ref{rml-kd45-sound}.
Strong completeness follows from the same reasoning as in Lemma~\ref{rml-k-sound-complete} for \axiomRmlK{}, using the provably correct translation from Lemma~\ref{rml-kd45-ml-equivalent}.
\end{proof}

The provably correct translations also imply that \logicRmlKFF{} is expressively equivalent to \logicKFF{} and \logicRmlKD{} is expressively equivalent to \logicKD{}.

\begin{corollary}
The logic \logicRmlKFF{} is expressively equivalent to the logic \logicKFF{}.
\end{corollary}

\begin{corollary}
The logic \logicRmlKD{} is expressively equivalent to the logic \logicKD{}.
\end{corollary}

Finally from expressive equivalence we have that \logicRmlKFF{} and \logicRmlKD{} are compact and decidable.

\begin{corollary}
The logics \logicRmlKFF{} and \logicRmlKD{} are compact.
\end{corollary}

\begin{corollary}
The satisfiability problems for the logics \logicRmlKFF{} and \logicRmlKD{} are decidable.
\end{corollary}
